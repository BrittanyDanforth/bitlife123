local events = {
	{
		id = "job_offer_barista",
		emoji = "‚òï",
		title = "Caf√© Job Offer",
		text = "A boutique caf√© downtown desperately needs help. They like your vibe.",
		category = "career",
		weight = 12,
		minAge = 15,
		maxAge = 30,
		requiresNoJob = true,
		blockedByFlags = { employed = true },
		choices = {
			{
				index = 1,
				text = "Accept job",
				effects = { Happiness = 3 },
				setFlags = { employed = true, has_job = true },
				feedText = "You got a job as a Barista at Bloom Cafe!",
				onResolve = function(state)
					if state.SetCareer then
						state:SetCareer({
							id = "barista",
							name = "Barista",
							company = "Bloom Cafe",
							salary = 24000,
							category = "service",
						})
					end
				end,
			},
			{
				index = 2,
				text = "Decline",
				effects = { Happiness = -1 },
				feedText = "You passed on the caf√© job.",
			},
		},
	},
	{
		id = "coding_bootcamp_offer",
		emoji = "üíª",
		title = "Coding Bootcamp Scholarship",
		text = "You win a partial scholarship to an elite coding bootcamp.",
		category = "career",
		weight = 6,
		minAge = 17,
		maxAge = 30,
		requiresFlags = { social_online = true },
		choices = {
			{
				index = 1,
				text = "Enroll",
				effects = { Smarts = 4, Money = -4000 },
				setFlags = { college_student = true, bootcamp_grad_pending = true },
				feedText = "You enrolled in Stacks Academy coding bootcamp!",
				onResolve = function(state)
					if state.EnrollEducation then
						state:EnrollEducation({
							name = "Stacks Academy",
							type = "bootcamp",
							cost = 4000,
							duration = 1,
						})
					end
				end,
			},
			{
				index = 2,
				text = "Skip it",
				effects = { Happiness = -2 },
				feedText = "You passed on the bootcamp.",
			},
		},
	},
	{
		id = "promotion_offer",
		emoji = "‚¨ÜÔ∏è",
		title = "Promotion Consideration",
		text = "Your manager calls you in to discuss a promotion with more responsibility.",
		category = "career",
		weight = 9,
		minAge = 20,
		requiresJob = true,
		requiresCareer = { minPerformance = 70, minYearsAtJob = 1 },
		requiresStats = { Smarts = 45 },
		choices = {
			{
				index = 1,
				text = "Accept promotion",
				effects = { Happiness = 3, Money = 5000 },
				feedText = "You were promoted!",
				onResolve = function(state)
					if state.CurrentJob then
						state.CurrentJob.salary = math.floor((state.CurrentJob.salary or 30000) * 1.35)
						state.CurrentJob.name = "Senior " .. (state.CurrentJob.name or "Associate")
					end
					if state.AddFeed then
						state:AddFeed("You were promoted!")
					end
					-- Reset/boost career progression
					if state.CareerInfo then
						state.CareerInfo.promotionProgress = 0
						state.CareerInfo.performance = math.min(100, (state.CareerInfo.performance or 70) + 5)
						state.CareerInfo.raises = (state.CareerInfo.raises or 0) + 1
					end
				end,
			},
			{
				index = 2,
				text = "Decline politely",
				effects = { Happiness = -1 },
				feedText = "You declined the promotion.",
			},
		},
	},
	-- Performance Review (positive/neutral/negative)
	{
		id = "performance_review",
		emoji = "üìà",
		title = "Annual Performance Review",
		text = "Your manager evaluates your yearly performance.",
		category = "career",
		weight = 10,
		minAge = 18,
		requiresJob = true,
		choices = {
			{
				index = 1,
				text = "Accept feedback and improve",
				effects = { Happiness = -1 },
				feedText = "You took the feedback seriously and made a plan.",
				onResolve = function(state)
					state.CareerInfo = state.CareerInfo or {}
					state.CareerInfo.performance = math.min(100, (state.CareerInfo.performance or 60) + 5)
					state.CareerInfo.promotionProgress = math.min(100, (state.CareerInfo.promotionProgress or 0) + 5)
				end,
				-- Hint a follow-up opportunity if they improve
				nextEventId = "promotion_offer",
			},
			{
				index = 2,
				text = "Defend your work",
				effects = { Happiness = -2 },
				feedText = "You pushed back on some points.",
			},
		},
	},
	-- Written Warning (low performance, tenure >= 0.5y)
	{
		id = "written_warning",
		emoji = "‚ö†Ô∏è",
		title = "Written Warning",
		text = "HR issues a formal warning due to poor performance or conduct.",
		category = "career",
		weight = 4,
		minAge = 18,
		requiresJob = true,
		requiresCareer = { minYearsAtJob = 0, maxPerformance = 45 },
		choices = {
			{
				index = 1,
				text = "Acknowledge and start improvement plan",
				effects = { Happiness = -3 },
				setFlags = { on_pip = true },
				feedText = "You agreed to a performance improvement plan (PIP).",
				onResolve = function(state)
					state.CareerInfo = state.CareerInfo or {}
					state.CareerInfo.performance = math.min(100, (state.CareerInfo.performance or 40) + 3)
				end,
			},
			{
				index = 2,
				text = "Refuse (risky)",
				effects = { Happiness = -5 },
				feedText = "You refused the PIP. This may not end well.",
				onResolve = function(state)
					state.Flags = state.Flags or {}
					state.Flags.refused_pip = true
				end,
			},
		},
	},
	-- Layoff / Termination (low performance + refusal or severe conditions)
	{
		id = "termination_meeting",
		emoji = "üßæ",
		title = "Difficult Meeting",
		text = "You're called into HR for an important discussion about your future at the company.",
		category = "career",
		weight = 2,
		minAge = 18,
		requiresJob = true,
		requiresCareer = { maxPerformance = 40, minYearsAtJob = 0 },
		requiresFlags = { refused_pip = true },
		choices = {
			{
				index = 1,
				text = "Negotiate severance",
				effects = { Money = 2000, Happiness = -6 },
				feedText = "You negotiated a severance package.",
				onResolve = function(state)
					if state.ClearCareer then
						state:ClearCareer()
					end
					state.Flags.refused_pip = nil
				end,
			},
			{
				index = 2,
				text = "Depart quietly",
				effects = { Happiness = -4 },
				feedText = "You left the company.",
				onResolve = function(state)
					if state.ClearCareer then
						state:ClearCareer()
					end
					state.Flags.refused_pip = nil
				end,
			},
		},
	},
}

return events
