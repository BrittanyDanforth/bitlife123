--[[
	Actor / Entertainment Career Events
	AAA-quality events with random BitLife-style outcomes
	User CANNOT control outcomes - everything is randomized
	
	Careers covered:
	- Actor/Extra
	- TV Actor
	- Movie Star
	- A-List Actor
	- Director
	- Producer
	
	CRITICAL FIX #RVS-5: Premium path blocking for royalty/mafia players
]]

local ActorCareerEvents = {}

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- CRITICAL FIX #RVS-ACTOR-1: Premium path blocking
-- Actor events should NOT fire for royalty or mafia players (unless already famous)
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
local function isBlockedByPremiumPath(state)
	if not state.Flags then return false end
	local flags = state.Flags
	
	-- If player is already an actor/famous, allow
	if flags.fame_career or flags.a_list_actor or flags.tv_regular then
		return false
	end
	if state.FameState and state.FameState.careerPath then
		return false
	end
	
	-- Block if player chose royalty path
	if flags.primary_wish_type == "royalty" then return true end
	if flags.is_royalty or flags.royal_birth or flags.dating_royalty then return true end
	if state.RoyalState and state.RoyalState.isRoyal then return true end
	
	-- Block if player chose mafia path
	if flags.primary_wish_type == "mafia" then return true end
	if flags.in_mob then return true end
	if state.MobState and state.MobState.inMob then return true end
	
	return false
end

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- CRITICAL FIX #11: Enhanced helper functions for acting career
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
local function hasActingJob(state)
	-- CRITICAL FIX #RVS-ACTOR-2: Check premium path blocking first
	if isBlockedByPremiumPath(state) then return false end
	if not state.CurrentJob then return false end
	local jobId = (state.CurrentJob.id or ""):lower()
	local jobCat = (state.CurrentJob.category or ""):lower()
	-- CRITICAL FIX #12: Exclude non-acting entertainment careers
	if jobId:find("athlete") or jobId:find("player") or jobId:find("singer") 
	   or jobId:find("musician") or jobId:find("rapper") or jobId:find("dj") then
		return false
	end
	return jobId:find("actor") or jobId:find("actress") or jobId:find("movie") or 
		   jobId:find("director") or jobId:find("producer") or 
		   (jobCat == "acting" or jobCat == "film")
end

local function isMovieStar(state)
	if not state.CurrentJob then return false end
	local jobId = (state.CurrentJob.id or ""):lower()
	return jobId:find("movie_star") or jobId:find("a_list") or jobId:find("film_actor")
		or (state.Flags and state.Flags.a_list_actor == true)
end

-- CRITICAL FIX #13: Check for TV actor specifically
local function isTVActor(state)
	if not state.CurrentJob then return false end
	local jobId = (state.CurrentJob.id or ""):lower()
	return jobId:find("tv_actor") or jobId:find("television") or jobId:find("sitcom")
		or (state.Flags and state.Flags.tv_regular == true)
end

-- CRITICAL FIX #14: Check if player is struggling/extra vs established
local function isEstablishedActor(state)
	if not hasActingJob(state) then return false end
	local fame = state.Fame or 0
	return fame >= 30 or isMovieStar(state) or isTVActor(state)
end

-- CRITICAL FIX #15: Prevent actor events for extras who aren't really actors yet
local function isNotJustExtra(state)
	if not state.CurrentJob then return false end
	local jobId = (state.CurrentJob.id or ""):lower()
	if jobId:find("extra") and not jobId:find("actor") then
		return (state.Fame or 0) >= 10 -- Extras need some fame first
	end
	return true
end

ActorCareerEvents.events = {
	-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
	-- AUDITION EVENTS
	-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
	{
		id = "actor_big_audition",
		title = "ğŸ¬ Big Audition!",
		emoji = "ğŸ¬",
		text = "You've got an audition for a major role in a blockbuster movie! This could change everything!",
		category = "career_acting",
		weight = 18,
		minAge = 18, maxAge = 60,
		baseChance = 0.5,
		cooldown = 4, -- CRITICAL FIX: Increased from 2 to reduce spam
		requiresJob = true,
		eligibility = hasActingJob,
		blockedByFlags = { in_prison = true },
		
		choices = {
			{
				text = "Prepare intensely - method acting",
				effects = { Health = -3 },
				feedText = "Living as the character for weeks...",
				onResolve = function(state)
					local roll = math.random(1, 100)
					if roll <= 45 then
						state.Money = (state.Money or 0) + math.random(100000, 500000)
						state:ModifyStat("Happiness", 25)
						state.Fame = math.min(100, (state.Fame or 0) + 40) -- CRITICAL FIX: Cap fame at 100
						state.Flags = state.Flags or {}
						state.Flags.landed_big_role = true
						state:AddFeed("ğŸ¬ YOU GOT THE ROLE! Career-defining moment! Filming starts next month!")
					elseif roll <= 75 then
						state:ModifyStat("Happiness", 5)
						state:AddFeed("ğŸ¬ They loved your audition but went with someone else. So close!")
					else
						state:ModifyStat("Happiness", -10)
						state:AddFeed("ğŸ¬ Casting director said your method acting was 'too much'. Ouch.")
					end
				end,
			},
			{
				text = "Stay natural - be yourself",
				effects = { Happiness = 3 },
				feedText = "Confidence is key...",
				onResolve = function(state)
					local roll = math.random(1, 100)
					if roll <= 35 then
						state.Money = (state.Money or 0) + math.random(50000, 200000)
						state:ModifyStat("Happiness", 20)
						state.Fame = math.min(100, (state.Fame or 0) + 30) -- CRITICAL FIX: Cap fame at 100
						state:AddFeed("ğŸ¬ Your natural charisma won them over! You're in!")
					elseif roll <= 70 then
						state:ModifyStat("Happiness", 2)
						state:AddFeed("ğŸ¬ Good audition, but they wanted someone with more 'range'.")
					else
						state:ModifyStat("Happiness", -8)
						state:AddFeed("ğŸ¬ They said you didn't bring enough energy. Tough business.")
					end
				end,
			},
		},
	},
	
	{
		id = "actor_scandal_photos",
		title = "ğŸ“¸ Paparazzi Scandal!",
		emoji = "ğŸ“¸",
		text = "Paparazzi caught you in a compromising situation! The tabloids are having a field day!",
		category = "career_acting",
		weight = 14,
		minAge = 18, maxAge = 60,
		baseChance = 0.45,
		cooldown = 3,
		requiresJob = true,
		eligibility = isMovieStar,
		blockedByFlags = { in_prison = true },
		
		choices = {
			{
				text = "Issue a public apology",
				effects = { Happiness = -5 },
				feedText = "Damage control mode...",
				onResolve = function(state)
					local roll = math.random(1, 100)
					if roll <= 60 then
						state:ModifyStat("Happiness", 5)
						state:AddFeed("ğŸ“¸ Public forgave you. The apology was well-received.")
					else
						state:ModifyStat("Happiness", -10)
						state.Fame = math.max(0, (state.Fame or 0) - 15) -- CRITICAL FIX: Prevent negative Fame
						state:AddFeed("ğŸ“¸ Apology made you look guilty. Should have stayed quiet.")
					end
				end,
			},
			{
				text = "Deny everything",
				effects = {},
				feedText = "Those photos are fake!",
				onResolve = function(state)
					local roll = math.random(1, 100)
					if roll <= 40 then
						state:ModifyStat("Happiness", 8)
						state.Fame = (state.Fame or 0) + 5
						state:AddFeed("ğŸ“¸ Managed to spin it! Media moved on to the next story.")
					else
						state:ModifyStat("Happiness", -15)
						state.Fame = math.max(0, (state.Fame or 0) - 25) -- CRITICAL FIX: Prevent negative Fame
						state.Flags = state.Flags or {}
						state.Flags.scandal_tainted = true
						state:AddFeed("ğŸ“¸ More photos emerged. Now you're a liar AND a scandal. Career hit!")
					end
				end,
			},
			{
				text = "Lean into it - all press is good press",
				effects = {},
				feedText = "Playing the villain...",
				onResolve = function(state)
					local roll = math.random(1, 100)
					if roll <= 50 then
						state.Fame = math.min(100, (state.Fame or 0) + 20) -- CRITICAL FIX: Cap fame at 100
						state:ModifyStat("Happiness", 10)
						state:AddFeed("ğŸ“¸ Your bad boy/girl image is now your brand! Offers for edgy roles!")
					else
						state:ModifyStat("Happiness", -8)
						state:AddFeed("ğŸ“¸ Studios don't want the drama. Several roles fell through.")
					end
				end,
			},
		},
	},
	
	{
		id = "actor_oscar_nomination",
		title = "ğŸ† Oscar Nomination!",
		emoji = "ğŸ†",
		text = "You've been nominated for an Academy Award! The biggest night in Hollywood is coming up!",
		category = "career_acting",
		weight = 10,
		minAge = 22, maxAge = 80,
		baseChance = 0.35,
		cooldown = 5,
		requiresJob = true,
		eligibility = isMovieStar,
		blockedByFlags = { in_prison = true, oscar_winner = true },
		
		choices = {
		{
			text = "Campaign hard for the win ($50K)",
			effects = { Money = -50000, Health = -3 },
			feedText = "For Your Consideration...",
			eligibility = function(state) return (state.Money or 0) >= 50000, "ğŸ’¸ Need $50K for Oscar campaign" end,
			onResolve = function(state)
					local roll = math.random(1, 100)
					if roll <= 40 then
						state.Money = (state.Money or 0) + math.random(500000, 2000000)
						state:ModifyStat("Happiness", 30)
						state.Fame = math.min(100, (state.Fame or 0) + 100) -- CRITICAL FIX: Cap fame at 100
						state.Flags = state.Flags or {}
						state.Flags.oscar_winner = true
						state:AddFeed("ğŸ† AND THE OSCAR GOES TO... YOU! Academy Award winner! This changes everything!")
					else
						state:ModifyStat("Happiness", 8)
						state.Fame = math.min(100, (state.Fame or 0) + 20) -- CRITICAL FIX: Cap fame at 100
						state:AddFeed("ğŸ† Didn't win, but being nominated was incredible! Your price went up!")
					end
				end,
			},
			{
				text = "Just enjoy the nomination",
				effects = { Happiness = 10 },
				feedText = "It's an honor just to be nominated...",
				onResolve = function(state)
					local roll = math.random(1, 100)
					if roll <= 25 then
						state.Money = (state.Money or 0) + math.random(300000, 1000000)
						state:ModifyStat("Happiness", 25)
						state.Fame = math.min(100, (state.Fame or 0) + 80) -- CRITICAL FIX: Cap fame at 100
						state.Flags = state.Flags or {}
						state.Flags.oscar_winner = true
						state:AddFeed("ğŸ† WON WITHOUT CAMPAIGNING! The most authentic Oscar speech ever!")
					else
						state:ModifyStat("Happiness", 5)
						state.Fame = math.min(100, (state.Fame or 0) + 15) -- CRITICAL FIX: Cap fame at 100
						state:AddFeed("ğŸ† Didn't win, but what a night! Career boost regardless!")
					end
				end,
			},
		},
	},
	
	{
		id = "actor_difficult_director",
		title = "Difficult Director",
		emoji = "ğŸ˜¤",
		text = "The director on your new film is INTENSE. They're demanding 50+ takes of every scene and publicly berating the cast.",
		category = "career_acting",
		weight = 14,
		minAge = 18, maxAge = 65,
		baseChance = 0.5,
		cooldown = 4, -- CRITICAL FIX: Increased from 2 to reduce spam
		requiresJob = true,
		eligibility = hasActingJob,
		blockedByFlags = { in_prison = true },
		
		choices = {
			{
				text = "Push through professionally",
				effects = { Happiness = -8, Health = -3 },
				feedText = "For the art...",
				onResolve = function(state)
					local roll = math.random(1, 100)
					if roll <= 60 then
						state:ModifyStat("Happiness", 15)
						state.Money = (state.Money or 0) + math.random(20000, 80000)
						state.Flags = state.Flags or {}
						state.Flags.professional_actor = true
						state:AddFeed("ğŸ˜¤ Film was a masterpiece! Director's vision paid off. Award buzz!")
					else
						state:ModifyStat("Happiness", -5)
						state:AddFeed("ğŸ˜¤ Film flopped despite all that torture. What was the point?")
					end
				end,
			},
			{
				text = "Stand up to the director",
				effects = {},
				feedText = "This is harassment!",
				onResolve = function(state)
					local roll = math.random(1, 100)
					if roll <= 35 then
						state:ModifyStat("Happiness", 12)
						state:AddFeed("ğŸ˜¤ Director backed down. Other actors thanked you for speaking up!")
					elseif roll <= 70 then
						state:ModifyStat("Happiness", -10)
						state:AddFeed("ğŸ˜¤ Got fired from the project. Word spreads - 'difficult to work with'.")
					else
						state:ModifyStat("Happiness", 5)
						state.Fame = math.min(100, (state.Fame or 0) + 10) -- CRITICAL FIX: Cap fame at 100
						state:AddFeed("ğŸ˜¤ Story went viral! Industry praised you for standing up to abuse!")
					end
				end,
			},
			{
				text = "Secretly record and document everything",
				effects = { Smarts = 2 },
				feedText = "Building a case...",
				onResolve = function(state)
					local roll = math.random(1, 100)
					if roll <= 40 then
						state.Money = (state.Money or 0) + math.random(100000, 500000)
						state:ModifyStat("Happiness", 15)
						state:AddFeed("ğŸ˜¤ ExposÃ© came out! Director's career over. Huge settlement for you!")
					else
						state:ModifyStat("Happiness", -5)
						state:AddFeed("ğŸ˜¤ Decided against going public. Sometimes silence is wisdom.")
					end
				end,
			},
		},
	},
	
	{
		id = "actor_typecasting",
		title = "Typecasting Problem",
		emoji = "ğŸ­",
		text = "You're becoming known for playing the same type of character. Directors only want you for that one role type.",
		category = "career_acting",
		weight = 12,
		minAge = 25, maxAge = 55,
		baseChance = 0.45,
		cooldown = 3,
		requiresJob = true,
		eligibility = hasActingJob,
		blockedByFlags = { in_prison = true },
		
		choices = {
			{
				text = "Take a completely different role",
				effects = { Smarts = 3 },
				feedText = "Proving your range...",
				onResolve = function(state)
					local roll = math.random(1, 100)
					if roll <= 45 then
						state.Money = (state.Money or 0) + math.random(50000, 200000)
						state:ModifyStat("Happiness", 15)
						state.Fame = math.min(100, (state.Fame or 0) + 20) -- CRITICAL FIX: Cap fame at 100
						state.Flags = state.Flags or {}
						state.Flags.versatile_actor = true
						state:AddFeed("ğŸ­ REVELATION! Critics amazed by your range! New phase of career!")
					elseif roll <= 75 then
						state:ModifyStat("Happiness", 3)
						state:AddFeed("ğŸ­ Mixed reviews. Some say stick to what you know.")
					else
						state:ModifyStat("Happiness", -10)
						state:AddFeed("ğŸ­ Film bombed. 'Miscast' written in every review. Painful.")
					end
				end,
			},
			{
				text = "Embrace your niche",
				effects = { Happiness = 5 },
				feedText = "If it works, why change?",
				onResolve = function(state)
					state.Money = (state.Money or 0) + math.random(30000, 100000)
					state:ModifyStat("Happiness", 8)
					state:AddFeed("ğŸ­ Steady work playing what audiences love! Not glamorous but reliable.")
				end,
			},
		},
	},
	
	{
		id = "actor_franchise_offer",
		title = "ğŸ¦¸ Superhero Franchise Offer!",
		emoji = "ğŸ¦¸",
		text = "A major studio wants you to play a superhero in their cinematic universe! Multi-movie deal!",
		category = "career_acting",
		weight = 10,
		minAge = 20, maxAge = 45,
		baseChance = 0.4,
		cooldown = 5,
		oneTime = true,
		requiresJob = true,
		eligibility = hasActingJob,
		blockedByFlags = { in_prison = true, franchise_star = true },
		
		choices = {
			{
				text = "Sign for 6 movies!",
				effects = { Happiness = 15 },
				feedText = "Time to become a superhero!",
				onResolve = function(state)
					local contract = math.random(5000000, 20000000)
					state.Money = (state.Money or 0) + contract
					state.Fame = math.min(100, (state.Fame or 0) + 80) -- CRITICAL FIX: Cap fame at 100
					state.Flags = state.Flags or {}
					state.Flags.franchise_star = true
					state.Flags.superhero_actor = true
					state:AddFeed(string.format("ğŸ¦¸ SUPERHERO! $%s contract! Kids will wear costumes of you!", contract))
				end,
			},
			{
				text = "Decline - superhero movies are beneath you",
				effects = { Smarts = 2 },
				feedText = "Real actors do prestige films...",
				onResolve = function(state)
					local roll = math.random(1, 100)
					if roll <= 40 then
						state:ModifyStat("Happiness", 10)
						state:AddFeed("ğŸ¦¸ Your indie career flourished! Credibility intact!")
					else
						state:ModifyStat("Happiness", -12)
						state:AddFeed("ğŸ¦¸ Watched the actor who replaced you become a megastar. Regrets.")
					end
				end,
			},
		},
	},
	
	{
		id = "actor_nude_scene",
		title = "Controversial Scene Request",
		emoji = "ğŸ˜³",
		text = "The script calls for a very explicit scene. The director says it's 'essential to the story'.",
		category = "career_acting",
		weight = 12,
		minAge = 21, maxAge = 50,
		baseChance = 0.45,
		cooldown = 3,
		requiresJob = true,
		eligibility = hasActingJob,
		blockedByFlags = { in_prison = true },
		
		choices = {
			{
				text = "Do the scene as written",
				effects = { Happiness = -3 },
				feedText = "It's art, right?",
				onResolve = function(state)
					local roll = math.random(1, 100)
					if roll <= 50 then
						state:ModifyStat("Happiness", 10)
						state.Fame = math.min(100, (state.Fame or 0) + 15) -- CRITICAL FIX: Cap fame at 100
						state:AddFeed("ğŸ˜³ Scene was tasteful and the film got critical acclaim. Worth it!")
					else
						state:ModifyStat("Happiness", -10)
						state:AddFeed("ğŸ˜³ Scene felt exploitative. Now it's everywhere online. Regrets.")
					end
				end,
			},
			{
				text = "Negotiate for a body double",
				effects = { Smarts = 2 },
				feedText = "Setting boundaries...",
				onResolve = function(state)
					local roll = math.random(1, 100)
					if roll <= 70 then
						state:ModifyStat("Happiness", 8)
						state:AddFeed("ğŸ˜³ Compromise reached! Scene still works with a double.")
					else
						state:ModifyStat("Happiness", -5)
						state:AddFeed("ğŸ˜³ Director refused. Had to choose between the role and your comfort.")
					end
				end,
			},
			{
				text = "Refuse completely",
				effects = { Happiness = 5 },
				setFlags = { maintains_boundaries = true },
				feedText = "Not comfortable with this.",
			},
		},
	},
	
	-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
	-- CRITICAL FIX #ACTOR-5: ADDED MANY MORE ACTOR EVENTS FOR VARIETY!
	-- User complaint: "ACTOR CAREER IDFK ENSURE IT WORKS"
	-- Adding diverse events ensures actors have engaging content throughout career
	-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
	
	{
		id = "actor_table_read",
		title = "ğŸ“– First Table Read",
		emoji = "ğŸ“–",
		text = "It's your first table read for a new project. All the cast is there. Time to make an impression.",
		category = "career_acting",
		weight = 14,
		minAge = 18, maxAge = 60,
		baseChance = 0.5,
		cooldown = 4, -- CRITICAL FIX: Increased from 2 to reduce spam
		requiresJob = true,
		eligibility = hasActingJob,
		blockedByFlags = { in_prison = true },
		
		choices = {
			{
				text = "Give it everything - steal the show",
				effects = { Happiness = 5 },
				feedText = "Time to shine!",
				onResolve = function(state)
					local roll = math.random(1, 100)
					if roll <= 55 then
						state:ModifyStat("Happiness", 15)
						state.Flags = state.Flags or {}
						state.Flags.scene_stealer = true
						state:AddFeed("ğŸ“– Everyone was laughing and engaged! Director said you have 'IT'!")
					elseif roll <= 85 then
						state:ModifyStat("Happiness", 5)
						state:AddFeed("ğŸ“– Great table read! Chemistry with the cast is solid.")
					else
						state:ModifyStat("Happiness", -8)
						state:AddFeed("ğŸ“– Came across as trying too hard. Lead actor looked annoyed.")
					end
				end,
			},
			{
				text = "Stay professional and measured",
				effects = { Smarts = 2 },
				feedText = "Save the best for filming.",
				onResolve = function(state)
					state:ModifyStat("Happiness", 5)
					state:AddFeed("ğŸ“– Solid professional performance. Building relationships with the team.")
				end,
			},
		},
	},
	
	{
		id = "actor_awards_show_drama",
		title = "ğŸ­ Awards Show Drama",
		emoji = "ğŸ­",
		text = "You're presenting at a major awards show when something unexpected happens live on stage!",
		category = "career_acting",
		weight = 10,
		minAge = 22, maxAge = 65,
		baseChance = 0.4,
		cooldown = 3,
		requiresJob = true,
		eligibility = isEstablishedActor,
		blockedByFlags = { in_prison = true },
		
		choices = {
			{
				text = "Roll with it - improv time",
				effects = { Happiness = 5 },
				feedText = "Live TV baby!",
				onResolve = function(state)
					local roll = math.random(1, 100)
					if roll <= 60 then
						state.Fame = math.min(100, (state.Fame or 0) + 25) -- CRITICAL FIX: Cap fame at 100
						state:ModifyStat("Happiness", 18)
						state:AddFeed("ğŸ­ Your improv saved the moment! Clip went viral! Best presenter ever!")
					else
						state:ModifyStat("Happiness", -5)
						state:AddFeed("ğŸ­ Tried to improv but it fell flat. At least you tried!")
					end
				end,
			},
			{
				text = "Stick to the script - stay safe",
				effects = { Smarts = 2 },
				feedText = "Professional mode.",
				onResolve = function(state)
					local roll = math.random(1, 100)
					if roll <= 50 then
						state:AddFeed("ğŸ­ Handled it gracefully. No memes, but no disasters.")
					else
						state:ModifyStat("Happiness", -3)
						state:AddFeed("ğŸ­ Came across as stiff. Internet wasn't kind.")
					end
				end,
			},
		},
	},
	
	{
		id = "actor_costar_romance",
		title = "ğŸ’• On-Set Romance?",
		emoji = "ğŸ’•",
		text = "There's undeniable chemistry between you and your co-star. The sparks are flying on and off camera!",
		category = "career_acting",
		weight = 12,
		minAge = 20, maxAge = 55,
		baseChance = 0.45,
		cooldown = 3,
		requiresJob = true,
		eligibility = hasActingJob,
		blockedByFlags = { in_prison = true, married = true },
		
		choices = {
			{
				text = "Explore the connection",
				effects = { Happiness = 10 },
				feedText = "Life imitating art...",
				onResolve = function(state)
					local roll = math.random(1, 100)
					if roll <= 40 then
						state:ModifyStat("Happiness", 20)
						state.Fame = math.min(100, (state.Fame or 0) + 30) -- CRITICAL FIX: Cap fame at 100
						state.Flags = state.Flags or {}
						state.Flags.hollywood_couple = true
						state:AddFeed("ğŸ’• Hollywood's hottest new couple! You're in love and the world is watching!")
					elseif roll <= 70 then
						state:ModifyStat("Happiness", 8)
						state:AddFeed("ğŸ’• Brief fling that ended amicably. Great memories!")
					else
						state:ModifyStat("Happiness", -15)
						state:AddFeed("ğŸ’• Messy breakup! Filming together is now extremely awkward!")
					end
				end,
			},
			{
				text = "Keep it professional",
				effects = { Smarts = 3 },
				feedText = "Don't mix business and pleasure.",
				onResolve = function(state)
					state:AddFeed("ğŸ’• Kept boundaries intact. The on-screen chemistry is even better now!")
				end,
			},
		},
	},
	
	{
		id = "actor_method_gone_wrong",
		title = "ğŸ­ Method Acting Crisis",
		emoji = "ğŸ­",
		text = "You've been doing intense method acting for your role as a disturbed character. It's affecting your real life.",
		category = "career_acting",
		weight = 10,
		minAge = 20, maxAge = 55,
		baseChance = 0.35,
		cooldown = 4,
		requiresJob = true,
		eligibility = hasActingJob,
		blockedByFlags = { in_prison = true },
		
		choices = {
			{
				text = "Break character - mental health first",
				effects = { Health = 5, Happiness = 5 },
				feedText = "It's just a role.",
				onResolve = function(state)
					state:AddFeed("ğŸ­ Stepped out of character. Feeling like yourself again. Good choice!")
				end,
			},
			{
				text = "Stay in character until wrap",
				effects = { Happiness = -10, Health = -8 },
				feedText = "THE CRAFT demands it...",
				onResolve = function(state)
					local roll = math.random(1, 100)
					if roll <= 45 then
						state:ModifyStat("Happiness", 25)
						state.Fame = math.min(100, (state.Fame or 0) + 35) -- CRITICAL FIX: Cap fame at 100
						state.Flags = state.Flags or {}
						state.Flags.method_master = true
						state:AddFeed("ğŸ­ Performance was TRANSFORMATIVE! Critics calling it career-defining!")
					else
						state:ModifyStat("Health", -10)
						state:AddFeed("ğŸ­ Had a mental health episode. Needed therapy after. Worth it?")
					end
				end,
			},
		},
	},
	
	{
		id = "actor_stunt_offer",
		title = "ğŸ”¥ Do Your Own Stunts?",
		emoji = "ğŸ”¥",
		text = "The director wants you to do a dangerous stunt yourself instead of using a stunt double. It would look incredible!",
		category = "career_acting",
		weight = 12,
		minAge = 20, maxAge = 50,
		baseChance = 0.45,
		cooldown = 4, -- CRITICAL FIX: Increased from 2 to reduce spam
		requiresJob = true,
		eligibility = hasActingJob,
		blockedByFlags = { in_prison = true },
		
		choices = {
			{
				text = "Go for it - full commitment!",
				effects = { Health = -5 },
				feedText = "Here goes nothing!",
				onResolve = function(state)
					local roll = math.random(1, 100)
					if roll <= 60 then
						state:ModifyStat("Happiness", 18)
						state.Fame = math.min(100, (state.Fame or 0) + 15) -- CRITICAL FIX: Cap fame at 100
						state.Flags = state.Flags or {}
						state.Flags.does_own_stunts = true
						state:AddFeed("ğŸ”¥ NAILED IT! Shot looks AMAZING! You're officially a badass!")
					elseif roll <= 90 then
						state:ModifyStat("Happiness", 5)
						state:AddFeed("ğŸ”¥ Completed the stunt safely! Small bruises but worth it!")
					else
						state:ModifyStat("Health", -20)
						state:ModifyStat("Happiness", -15)
						state:AddFeed("ğŸ”¥ INJURED! Stunt went wrong! Production halted for your recovery!")
					end
				end,
			},
			{
				text = "Use the stunt double",
				effects = { Health = 2, Smarts = 2 },
				feedText = "That's what they're paid for.",
				onResolve = function(state)
					state:AddFeed("ğŸ”¥ Smart choice. Stunt double nailed it. No broken bones for you!")
				end,
			},
		},
	},
	
	{
		id = "actor_talk_show",
		title = "ğŸ“º Talk Show Appearance",
		emoji = "ğŸ“º",
		text = "You're booked on a major late night talk show! Time to promote your new project and show your personality!",
		category = "career_acting",
		weight = 14,
		minAge = 18, maxAge = 70,
		baseChance = 0.5,
		cooldown = 4, -- CRITICAL FIX: Increased from 2 to reduce spam
		requiresJob = true,
		eligibility = hasActingJob,
		blockedByFlags = { in_prison = true },
		
		choices = {
			{
				text = "Tell a wild story",
				effects = { Happiness = 8 },
				feedText = "Time for that crazy anecdote!",
				onResolve = function(state)
					local roll = math.random(1, 100)
					if roll <= 55 then
						state.Fame = math.min(100, (state.Fame or 0) + 20) -- CRITICAL FIX: Cap fame at 100
						state:ModifyStat("Happiness", 12)
						state:AddFeed("ğŸ“º VIRAL MOMENT! Your story has millions of views! Great promo!")
					else
						state:ModifyStat("Happiness", 5)
						state:AddFeed("ğŸ“º Got some laughs! Good TV appearance overall!")
					end
				end,
			},
			{
				text = "Stay on message - promote the project",
				effects = { Smarts = 2 },
				feedText = "Professional mode.",
				onResolve = function(state)
					state:AddFeed("ğŸ“º Professional appearance. Studio is happy with the coverage!")
				end,
			},
			{
				text = "Play a game/do a bit with the host",
				effects = { Happiness = 10 },
				feedText = "Let's have fun with this!",
				onResolve = function(state)
					local roll = math.random(1, 100)
					if roll <= 65 then
						state.Fame = math.min(100, (state.Fame or 0) + 15) -- CRITICAL FIX: Cap fame at 100
						state:ModifyStat("Happiness", 10)
						state:AddFeed("ğŸ“º Amazing chemistry with the host! They want you back anytime!")
					else
						state:AddFeed("ğŸ“º Fun bit! You seemed relatable and down to earth!")
					end
				end,
			},
		},
	},
	
	{
		id = "actor_voice_acting",
		title = "ğŸ™ï¸ Voice Acting Opportunity",
		emoji = "ğŸ™ï¸",
		text = "An animated movie wants you to voice a major character! Different skill set than regular acting.",
		category = "career_acting",
		weight = 12,
		minAge = 20, maxAge = 70,
		baseChance = 0.45,
		cooldown = 3,
		requiresJob = true,
		eligibility = hasActingJob,
		blockedByFlags = { in_prison = true },
		
		choices = {
			{
				text = "Accept - expand your range",
				effects = { Happiness = 8 },
				feedText = "Voice acting is real acting!",
				onResolve = function(state)
					local earnings = math.random(100000, 800000)
					state.Money = (state.Money or 0) + earnings
					local roll = math.random(1, 100)
					if roll <= 50 then
						state.Fame = math.min(100, (state.Fame or 0) + 25) -- CRITICAL FIX: Cap fame at 100
						state.Flags = state.Flags or {}
						state.Flags.voice_actor = true
						state:AddFeed(string.format("ğŸ™ï¸ Movie was a HIT! Kids love your character! Sequel confirmed! Earned $%d!", earnings))
					else
						state:AddFeed(string.format("ğŸ™ï¸ Fun experience! Earned $%d for the voice work!", earnings))
					end
				end,
			},
			{
				text = "Decline - focus on live action",
				effects = { Smarts = 1 },
				feedText = "Staying in your lane.",
				onResolve = function(state)
					local roll = math.random(1, 100)
					if roll <= 30 then
						state:ModifyStat("Happiness", -8)
						state:AddFeed("ğŸ™ï¸ That movie became a massive franchise. The actor who replaced you is iconic now...")
					else
						state:AddFeed("ğŸ™ï¸ Focused on your strengths. No regrets!")
					end
				end,
			},
		},
	},
	
	{
		id = "actor_red_carpet",
		title = "ğŸ‘— Red Carpet Moment",
		emoji = "ğŸ‘—",
		text = "Major premiere tonight! Your red carpet look will be scrutinized by millions! What's the move?",
		category = "career_acting",
		weight = 12,
		minAge = 18, maxAge = 65,
		baseChance = 0.5,
		cooldown = 4, -- CRITICAL FIX: Increased from 2 to reduce spam
		requiresJob = true,
		eligibility = hasActingJob,
		blockedByFlags = { in_prison = true },
		
		choices = {
			{
				text = "Go all out - designer everything ($10,000)",
				effects = { Happiness = 8 },
				feedText = "Dress to impress!",
				onResolve = function(state)
					if (state.Money or 0) >= 10000 then
						-- CRITICAL FIX: Prevent negative money
						state.Money = math.max(0, (state.Money or 0) - 10000)
						local roll = math.random(1, 100)
						if roll <= 60 then
							state.Fame = math.min(100, (state.Fame or 0) + 20) -- CRITICAL FIX: Cap fame at 100
							state:ModifyStat("Happiness", 15)
							state:AddFeed("ğŸ‘— BEST DRESSED! Fashion magazines are calling! Style icon status!")
						elseif roll <= 90 then
							state:ModifyStat("Happiness", 8)
							state:AddFeed("ğŸ‘— Looked amazing! Great photos everywhere!")
						else
							state:ModifyStat("Happiness", -10)
							state:AddFeed("ğŸ‘— Made worst dressed lists. Should have gone simpler...")
						end
					else
						state:AddFeed("ğŸ‘— Can't afford the designer look right now. Had to improvise!")
					end
				end,
			},
			{
				text = "Classic and elegant",
				effects = { Smarts = 2 },
				feedText = "Timeless never fails.",
				onResolve = function(state)
					state:ModifyStat("Happiness", 8)
					state:AddFeed("ğŸ‘— Classy and elegant! Maybe not best dressed, but definitely not worst!")
				end,
			},
			{
				text = "Make a statement - go bold",
				effects = {},
				feedText = "Fashion is art!",
				onResolve = function(state)
					local roll = math.random(1, 100)
					if roll <= 45 then
						state.Fame = math.min(100, (state.Fame or 0) + 30) -- CRITICAL FIX: Cap fame at 100
						state:ModifyStat("Happiness", 15)
						state:AddFeed("ğŸ‘— ICONIC! Your look broke the internet! Memes for days - in a good way!")
					else
						state:ModifyStat("Happiness", -8)
						state.Fame = math.min(100, (state.Fame or 0) + 10) -- CRITICAL FIX: Cap fame at 100
						state:AddFeed("ğŸ‘— Well... people are talking. 'Bold choice' is what they're saying...")
					end
				end,
			},
		},
	},
	
	{
		id = "actor_commercial_offer",
		title = "ğŸ“º Big Commercial Deal",
		emoji = "ğŸ“º",
		text = "A major brand wants you for their ad campaign. Easy money but some actors think commercials are 'selling out'.",
		category = "career_acting",
		weight = 14,
		minAge = 18, maxAge = 65,
		baseChance = 0.5,
		cooldown = 4, -- CRITICAL FIX: Increased from 2 to reduce spam
		requiresJob = true,
		eligibility = hasActingJob,
		blockedByFlags = { in_prison = true },
		
		choices = {
			{
				text = "Take the money!",
				effects = { Happiness = 5 },
				feedText = "A paycheck is a paycheck!",
				onResolve = function(state)
					local earnings = math.random(50000, 500000)
					state.Money = (state.Money or 0) + earnings
					state:AddFeed(string.format("ğŸ“º Easy $%d! Commercial airs everywhere! Your face is in every living room!", earnings))
				end,
			},
			{
				text = "Decline - protect your artistic integrity",
				effects = { Smarts = 3 },
				feedText = "I'm a serious actor...",
				onResolve = function(state)
					local roll = math.random(1, 100)
					if roll <= 40 then
						state:ModifyStat("Happiness", 8)
						state:AddFeed("ğŸ“º Fellow actors respect your integrity! Landed a prestige role instead!")
					else
						state:ModifyStat("Happiness", -5)
						state:AddFeed("ğŸ“º Could've used that money... Principles don't pay the rent.")
					end
				end,
			},
		},
	},
	
	{
		id = "actor_reboot_callback",
		title = "ğŸ” Franchise Reboot!",
		emoji = "ğŸ”",
		text = "The franchise you starred in years ago is being rebooted! They want you to cameo!",
		category = "career_acting",
		weight = 10,
		minAge = 35, maxAge = 75,
		baseChance = 0.35,
		cooldown = 5,
		requiresJob = true,
		eligibility = isEstablishedActor,
		blockedByFlags = { in_prison = true },
		
		choices = {
			{
				text = "Gladly return - for the fans!",
				effects = { Happiness = 15 },
				feedText = "Nostalgia time!",
				onResolve = function(state)
					local earnings = math.random(200000, 1000000)
					state.Money = (state.Money or 0) + earnings
					state.Fame = math.min(100, (state.Fame or 0) + 30) -- CRITICAL FIX: Cap fame at 100
					state:AddFeed(string.format("ğŸ” FANS WENT WILD! Your cameo was the best part! $%d for a few days work!", earnings))
				end,
			},
			{
				text = "Demand more money",
				effects = {},
				feedText = "Know your worth...",
				onResolve = function(state)
					local roll = math.random(1, 100)
					if roll <= 50 then
						local bigPay = math.random(500000, 3000000)
						state.Money = (state.Money or 0) + bigPay
						state:ModifyStat("Happiness", 15)
						state:AddFeed(string.format("ğŸ” They paid up! $%d for the cameo! You're irreplaceable!", bigPay))
					else
						state:ModifyStat("Happiness", -10)
						state:AddFeed("ğŸ” They recast your role with someone cheaper. Fans are furious at THEM, not you.")
					end
				end,
			},
			{
				text = "Decline - move forward",
				effects = { Smarts = 2 },
				feedText = "That chapter is closed.",
				onResolve = function(state)
					state:AddFeed("ğŸ” Let the new generation have their moment. You've done your part!")
				end,
			},
		},
	},
	
	{
		id = "actor_theater_return",
		title = "ğŸ­ Return to Theater",
		emoji = "ğŸ­",
		text = "A prestigious Broadway/West End production wants you for the lead! Theater is harder but more artistically fulfilling.",
		category = "career_acting",
		weight = 10,
		minAge = 25, maxAge = 70,
		baseChance = 0.4,
		cooldown = 4,
		requiresJob = true,
		eligibility = hasActingJob,
		blockedByFlags = { in_prison = true },
		
		choices = {
			{
				text = "Accept - back to your roots!",
				effects = { Happiness = 10, Health = -3 },
				feedText = "Live theater is the purest form!",
				onResolve = function(state)
					local roll = math.random(1, 100)
					if roll <= 55 then
						state:ModifyStat("Happiness", 18)
						state.Fame = math.min(100, (state.Fame or 0) + 25) -- CRITICAL FIX: Cap fame at 100
						state.Flags = state.Flags or {}
						state.Flags.theater_actor = true
						state:AddFeed("ğŸ­ STANDING OVATIONS! Tony/Olivier buzz! Reminded everyone you can REALLY act!")
					else
						state:AddFeed("ğŸ­ Great reviews! 8 shows a week is brutal but fulfilling!")
					end
				end,
			},
			{
				text = "Decline - films pay better",
				effects = { Smarts = 1 },
				feedText = "Business decision.",
				onResolve = function(state)
					state:AddFeed("ğŸ­ Stuck to the movie grind. Maybe someday you'll return to the stage.")
				end,
			},
		},
	},
	
	{
		id = "actor_fan_encounter",
		title = "ğŸŒŸ Obsessed Fan",
		emoji = "ğŸŒŸ",
		text = "A fan has been showing up everywhere you go. They know your schedule. This is getting creepy...",
		category = "career_acting",
		weight = 10,
		minAge = 20, maxAge = 65,
		baseChance = 0.35,
		cooldown = 4,
		requiresJob = true,
		eligibility = isEstablishedActor,
		blockedByFlags = { in_prison = true },
		
		choices = {
			{
				text = "Get a restraining order",
				effects = { Smarts = 3 },
				feedText = "Safety first.",
				onResolve = function(state)
					state.Money = math.max(0, (state.Money or 0) - math.random(5000, 15000))
					state:ModifyStat("Happiness", 5)
					state:AddFeed("ğŸŒŸ Restraining order granted. Hired security. Feel safer now.")
				end,
			},
			{
				text = "Try to talk to them",
				effects = { Happiness = -5 },
				feedText = "Maybe I can reason with them...",
				onResolve = function(state)
					local roll = math.random(1, 100)
					if roll <= 30 then
						state:ModifyStat("Happiness", 10)
						state:AddFeed("ğŸŒŸ They apologized and understood they crossed a line. Crisis averted!")
					elseif roll <= 80 then
						state:ModifyStat("Happiness", -10)
						state:AddFeed("ğŸŒŸ Made it worse. They thought you were being 'special' to them. Yikes.")
					else
						state:ModifyStat("Happiness", -15)
						state:ModifyStat("Health", -5)
						state:AddFeed("ğŸŒŸ Scary encounter! Had to call police! Traumatizing experience!")
					end
				end,
			},
			{
				text = "Ignore it and hope it stops",
				effects = {},
				feedText = "Maybe they'll lose interest...",
				onResolve = function(state)
					local roll = math.random(1, 100)
					if roll <= 50 then
						state:AddFeed("ğŸŒŸ They moved on eventually. Dodged a bullet!")
					else
						state:ModifyStat("Happiness", -8)
						state:AddFeed("ğŸŒŸ Escalated! Now they're sending stuff to your house! Should've acted sooner!")
					end
				end,
			},
		},
	},
}

return ActorCareerEvents
