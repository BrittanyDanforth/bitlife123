--[[
	â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
	â•‘              RAPPER & CONTENT CREATOR CAREER EXPANSION                       â•‘
	â•‘                    MASSIVE 2000+ LINE EXPANSION                              â•‘
	â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
	â•‘  From underground nobody to legendary superstar - the grind is REAL!         â•‘
	â•‘                                                                              â•‘
	â•‘  RAPPER PATH:                                                                â•‘
	â•‘    Underground â†’ Local â†’ Regional â†’ Signed â†’ Hot â†’ Mainstream â†’ Legend       â•‘
	â•‘                                                                              â•‘
	â•‘  CONTENT CREATOR PATH:                                                       â•‘
	â•‘    Newbie â†’ Small â†’ Growing â†’ Partner â†’ Viral â†’ Famous â†’ Icon                â•‘
	â•‘                                                                              â•‘
	â•‘  REQUIRES: Celebrity Gamepass for premium progression                        â•‘
	â•‘                                                                              â•‘
	â•‘  CRITICAL FIX #RVS-4: Premium path blocking for royalty/mafia players        â•‘
	â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
]]

local RapperContentCreatorEvents = {}

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- CRITICAL FIX #RVS-FAME-1: Premium path blocking
-- Fame/entertainment events should NOT fire for royalty or mafia players
-- unless they're already on the celebrity path
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
local function isBlockedByPremiumPath(state)
	if not state.Flags then return false end
	local flags = state.Flags
	
	-- If player is already a famous entertainer, allow
	if flags.fame_career or flags.is_famous then
		return false
	end
	if state.FameState and state.FameState.careerPath then
		return false
	end
	
	-- Block if player chose royalty path
	if flags.primary_wish_type == "royalty" then return true end
	if flags.is_royalty or flags.royal_birth or flags.dating_royalty then return true end
	if state.RoyalState and state.RoyalState.isRoyal then return true end
	
	-- Block if player chose mafia path
	if flags.primary_wish_type == "mafia" then return true end
	if flags.in_mob then return true end
	if state.MobState and state.MobState.inMob then return true end
	
	return false
end

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- CRITICAL FIX #509: Helper functions to check for rapper/creator careers
-- The job grants "rapper" flag but events were checking "pursuing_rap" - MISMATCH!
-- These helpers check BOTH the job AND the flags to ensure events trigger properly
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- CRITICAL FIX #MOBILE-7: STRICT rapper check - MUST NOT trigger for streamers!
-- BUG: Rapper events were firing for streamers because checks were too loose
-- FIX: Now explicitly BLOCKS streamers/creators before checking for rapper status
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
local function isRapper(state)
	-- CRITICAL FIX #RVS-FAME-2: Check premium path blocking first
	if isBlockedByPremiumPath(state) then return false end
	
	-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
	-- CRITICAL FIX: Block if player has ANY non-rapper formal job!
	-- A penetration tester, office worker, doctor, etc. should NOT get rapper events
	-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
	if state.CurrentJob then
		local jobId = (state.CurrentJob.id or ""):lower()
		local jobName = (state.CurrentJob.name or ""):lower()
		local jobCat = (state.CurrentJob.category or ""):lower()
		
		-- First check if it IS a rapper job
		local isRapperJob = jobId:find("rapper") or jobName:find("rapper") or jobName:find("hip.?hop")
			or jobId:find("underground_rapper") or jobId:find("local_rapper") or jobId:find("buzzing_rapper")
			or jobId:find("signed_rapper") or jobId:find("hot_rapper") or jobId:find("mainstream_rapper")
		
		if isRapperJob then
			return true  -- Is a rapper job - allow rapper events!
		end
		
		-- If they have ANY other job, block rapper events!
		-- This prevents penetration testers, doctors, lawyers, etc from getting rapper events
		if jobId ~= "" and jobName ~= "" then
			-- Allow rapper events ONLY if the job is clearly music/entertainment related
			local isEntertainmentJob = jobCat == "entertainment" or jobCat == "music" or jobCat == "celebrity"
				or jobId:find("musician") or jobId:find("singer") or jobId:find("artist")
				or jobName:find("musician") or jobName:find("singer") or jobName:find("artist")
			
			if not isEntertainmentJob then
				return false  -- Has a non-entertainment job - NOT a rapper!
			end
		end
	end
	
	-- CRITICAL FIX: Check if player is a streamer/creator BY JOB - if so, return FALSE immediately!
	if state.CurrentJob then
		local jobId = (state.CurrentJob.id or ""):lower()
		local jobName = (state.CurrentJob.name or ""):lower()
		if jobId:find("streamer") or jobId:find("creator") or jobId:find("youtuber") or jobId:find("influencer")
		   or jobName:find("streamer") or jobName:find("content creator") or jobName:find("youtuber") then
			return false  -- STREAMER/CREATOR JOB - NOT a rapper!
		end
	end

	-- CRITICAL FIX: Check for streamer/creator FLAGS - these block rapper status
	if state.Flags then
		local hasStreamerFlags = state.Flags.streamer or state.Flags.content_creator
			or state.Flags.pursuing_streaming or state.Flags.broadcaster
			or state.Flags.first_video_uploaded or state.Flags.first_video_posted
		local hasRapperFlags = state.Flags.rapper or state.Flags.pursuing_rap or state.Flags.underground_artist

		if hasStreamerFlags and not hasRapperFlags then
			return false  -- STREAMER FLAGS - NOT a rapper!
		end
	end

	-- CRITICAL FIX: Only allow rapper events if player has rapper flags AND no formal job
	if state.Flags then
		if state.Flags.rapper or state.Flags.pursuing_rap or state.Flags.underground_artist
		   or state.Flags.hip_hop_experience or state.Flags.trap_rapper or state.Flags.lyrical_rapper
		   or state.Flags.melodic_rapper or state.Flags.drill_rapper then
			-- Has rapper flags - but only allow if they don't have a conflicting formal job
			if not state.CurrentJob or not state.CurrentJob.id or state.CurrentJob.id == "" then
				return true  -- No job, has rapper flags - allow!
			end
		end
	end
	return false
end

local function isContentCreator(state)
	-- CRITICAL FIX #RVS-FAME-3: Check premium path blocking first
	if isBlockedByPremiumPath(state) then return false end
	
	-- Check job
	if state.CurrentJob then
		local jobId = (state.CurrentJob.id or ""):lower()
		local jobName = (state.CurrentJob.name or ""):lower()
		local jobCat = (state.CurrentJob.category or ""):lower()
		if jobId:find("creator") or jobId:find("streamer") or jobId:find("youtuber") or jobId:find("influencer") then
			return true
		end
		if (jobCat == "entertainment" or jobCat == "creative") and (jobName:find("creator") or jobName:find("stream") or jobName:find("youtube")) then
			return true
		end
	end
	-- Check flags
	if state.Flags then
		if state.Flags.content_creator or state.Flags.streamer or state.Flags.pursuing_streaming 
		   or state.Flags.pursuing_influencer or state.Flags.pursuing_content or state.Flags.youtuber
		   or state.Flags.social_media_presence or state.Flags.first_video_uploaded then
			return true
		end
	end
	return false
end

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- RAPPER CAREER EVENTS - From the basement to the main stage
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

RapperContentCreatorEvents.events = {
	-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
	-- UNDERGROUND RAPPER EVENTS (0-1000 monthly listeners)
	-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
	{
		id = "rapper_first_track",
		title = "ğŸ¤ Recording Your First Track",
		emoji = "ğŸ¤",
		text = "You've been writing bars in your Notes app for MONTHS. Rhymes in the shower, freestyling on the bus, beatboxing in class. Now it's time to make something REAL. You found a basement studio run by some dude named Marcus who charges $50/hour. The equipment is old, the room smells like weed and pizza, but this is where legends start. Your heart is pounding. This is the moment you stop being someone who WANTS to rap and become someone who ACTUALLY raps. What sound defines YOU?",
		question = "This first track will shape your whole career. What's your style?",
		minAge = 14, maxAge = 55,
		baseChance = 1.0,
		cooldown = 0,
		oneTime = true,
		priority = "high",
		isMilestone = true,
		category = "career_rapper",
		eligibility = function(state)
			if state.CurrentJob then
				local jobId = (state.CurrentJob.id or ""):lower()
				if jobId:find("streamer") or jobId:find("creator") or jobId:find("youtuber") or jobId:find("influencer") then
					return false, "This event is for rappers, not content creators"
				end
			end
			if state.CurrentJob then
				local jobId = (state.CurrentJob.id or ""):lower()
				local jobName = (state.CurrentJob.name or ""):lower()
				if jobId:find("rapper") or jobName:find("rapper") or jobName:find("hip.?hop") then
					return true
				end
			end
			if state.Flags then
				if state.Flags.rapper or state.Flags.pursuing_rap or state.Flags.underground_artist 
				   or state.Flags.hip_hop_experience then
					return true
				end
			end
			return false
		end,
		blockedByFlags = { first_track_recorded = true },
		
		choices = {
			{
				text = "ğŸ”¥ Aggressive trap banger - 808s and energy",
				effects = { Happiness = 15, Smarts = 2, Health = -3, Money = -50 },  -- ENHANCED: Recording is tiring!
				setFlags = { first_track_recorded = true, trap_rapper = true },
				feedText = "ğŸ¤ YOU DID IT! 4 hours in that basement, voice raw from 23 takes, but you walked out with YOUR FIRST SONG. It's aggressive, the 808s hit hard, and when you played it back in the car... goosebumps. You sent it to 3 friends - they're already asking for more. This is just the beginning. Your Spotify artist page is LIVE.",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					-- CRITICAL FIX: Ensure careerPath is set so FameState gets serialized!
					state.FameState.careerPath = state.FameState.careerPath or "rapper"
					state.FameState.isFamous = true
					state.FameState.monthlyListeners = math.random(10, 100)
					state.FameState.totalStreams = math.random(50, 500)
					state.FameState.totalTracks = 1
					state.FameState.style = "trap"
					state.Fame = (state.Fame or 0) + 1
				end,
			},
			{
				text = "ğŸ“š Lyrical conscious rap - real bars, real message",
				effects = { Happiness = 12, Smarts = 5, Health = -2, Money = -50 },  -- ENHANCED: Lyrical = smarts boost
				setFlags = { first_track_recorded = true, lyrical_rapper = true },
				feedText = "ğŸ¤ YOU POURED YOUR SOUL INTO THOSE BARS. 3 verses, no hook, just pure lyrics about life, struggle, and dreams. Marcus said 'yo, you actually have something to say.' The underground will respect this. It's not for everyone, but the ones who get it will REALLY get it. Posted on SoundCloud - 47 plays in the first week. Small start, big potential.",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					-- CRITICAL FIX: Ensure careerPath is set so FameState gets serialized!
					state.FameState.careerPath = state.FameState.careerPath or "rapper"
					state.FameState.isFamous = true
					state.FameState.monthlyListeners = math.random(10, 100)
					state.FameState.totalStreams = math.random(50, 500)
					state.FameState.totalTracks = 1
					state.FameState.style = "lyrical"
					state.Fame = (state.Fame or 0) + 1
				end,
			},
			{
				text = "ğŸµ Melodic auto-tune vibes - modern sound",
				effects = { Happiness = 15, Looks = 2, Health = -2, Money = -50 },  -- ENHANCED: Melodic = image boost
				setFlags = { first_track_recorded = true, melodic_rapper = true },
				feedText = "ğŸ¤ THE AUTO-TUNE MADE YOUR VOICE SOUND CRAZY. That melodic flow, the emotional delivery... Marcus had to double-check you hadn't done this before. You layered harmonies, ad-libs, everything. It sounds like something that could be on the radio. TikTok could blow this up. You're already thinking about the music video...",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					-- CRITICAL FIX: Ensure careerPath is set so FameState gets serialized!
					state.FameState.careerPath = state.FameState.careerPath or "rapper"
					state.FameState.isFamous = true
					state.FameState.monthlyListeners = math.random(10, 100)
					state.FameState.totalStreams = math.random(50, 500)
					state.FameState.totalTracks = 1
					state.FameState.style = "melodic"
					state.Fame = (state.Fame or 0) + 1
				end,
			},
			{
				text = "ğŸ”« Drill/Street rap - raw and real",
				effects = { Happiness = 12, Health = -4, Money = -50 },  -- ENHANCED: Drill is risky
				setFlags = { first_track_recorded = true, drill_rapper = true },
				feedText = "ğŸ¤ You recorded your first track! Hard drill beat. Streets will feel this!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					-- CRITICAL FIX: Ensure careerPath is set so FameState gets serialized!
					state.FameState.careerPath = state.FameState.careerPath or "rapper"
					state.FameState.isFamous = true
					state.FameState.monthlyListeners = math.random(10, 100)
					state.FameState.totalStreams = math.random(50, 500)
					state.FameState.totalTracks = 1
					state.FameState.style = "drill"
					state.Fame = (state.Fame or 0) + 1
				end,
			},
		},
	},
	{
		id = "rapper_soundcloud_grind",
		title = "ğŸ§ SoundCloud Grind",
		emoji = "ğŸ§",
		text = "You uploaded your tracks to SoundCloud. Time to promote! You're spending hours DMing people, posting in forums, begging for listens.",
		question = "How do you promote yourself?",
		minAge = 14, maxAge = 40,
		baseChance = 0.6,
		cooldown = 3, -- CRITICAL FIX: Increased cooldown to reduce spam
		maxOccurrences = 2, -- CRITICAL FIX: Can only happen twice max
		category = "career_rapper",  -- FIXED: Use career_rapper not career_music
		requiresFlags = { first_track_recorded = true },
		-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
		-- CRITICAL FIX #AAA-7: Block this event if player has progressed past underground stage
		-- This was firing even when player had already done shows, gotten signed, etc.
		-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
		blockedByFlags = { 
			first_show_done = true,      -- Already done live shows
			signed_artist = true,        -- Already signed to a label
			label_deal = true,           -- Has a label deal
			charting_artist = true,      -- Has charted
			mainstream_fame = true,      -- Is mainstream
			buzz = true,                 -- Already has buzz
			local_fame = true,           -- Known locally
			viral_hit = true,            -- Had a viral moment
			professional_music_career = true, -- Pro career
		},
		-- CRITICAL FIX: Also check career progression level
		eligibility = function(state)
			-- Block if job is beyond underground level
			if state.CurrentJob then
				local jobId = (state.CurrentJob.id or ""):lower()
				-- These are post-soundcloud-grind positions
				if jobId:find("local_rapper") or jobId:find("buzzing") or jobId:find("signed") 
				   or jobId:find("hot_rapper") or jobId:find("mainstream") or jobId:find("superstar") 
				   or jobId:find("legend") then
					return false
				end
			end
			-- Block if fame is too high (past underground level)
			if state.FameState then
				local listeners = state.FameState.monthlyListeners or 0
				if listeners > 5000 then
					return false -- Too big for SoundCloud grind
				end
			end
			return true
		end,
		
		choices = {
			{
				text = "Spam everyone with links",
				effects = { Happiness = -5 },
				feedText = "People are annoyed. You got blocked by 50 accounts. But 3 people actually listened!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					state.FameState.monthlyListeners = (state.FameState.monthlyListeners or 0) + math.random(5, 30)
				end,
			},
			{
				text = "Comment on other artists' tracks genuinely",
				effects = { Happiness = 5 },
				setFlags = { networking_rapper = true },
				feedText = "You're building relationships! Some artists checked you out back. Slow but organic growth!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					state.FameState.monthlyListeners = (state.FameState.monthlyListeners or 0) + math.random(20, 80)
					state.FameState.connections = (state.FameState.connections or 0) + 1
				end,
			},
			{
				text = "Pay for promotion ($100)",
				effects = { Happiness = 3, Money = -100 },
				feedText = "Paid for SoundCloud promotion. Got some plays but mostly bots. Learning experience.",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					local listeners = math.random(50, 200)
					state.FameState.monthlyListeners = (state.FameState.monthlyListeners or 0) + listeners
					state.FameState.totalStreams = (state.FameState.totalStreams or 0) + listeners * 3
				end,
			},
			{
				text = "Focus on making more music",
				effects = { Happiness = 8, Smarts = 2 },
				setFlags = { prolific_rapper = true },
				feedText = "You recorded 5 more tracks! Quality is improving. People notice when you're consistent!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					state.FameState.tracksReleased = (state.FameState.tracksReleased or 1) + 5
					state.FameState.monthlyListeners = (state.FameState.monthlyListeners or 0) + math.random(30, 100)
				end,
			},
		},
	},
	{
		id = "rapper_first_show",
		title = "ğŸ¤ Your First Live Performance",
		emoji = "ğŸ¤",
		text = "A local venue is doing an open mic night. You could perform your tracks live for the first time. Terrifying but exciting!",
		question = "Do you perform?",
		minAge = 16, maxAge = 45,
		baseChance = 0.7, -- CRITICAL FIX #518: Increased from 0.5 to 0.7
		cooldown = 1, -- CRITICAL FIX #519: Reduced from 3 to 1 for more events
		oneTime = true,
		category = "career_rapper",  -- FIXED: Use career_rapper not career_music
		-- CRITICAL FIX #520: Accept multiple flags for rapper eligibility
		eligibility = function(state)
			if state.Flags and (state.Flags.first_track_recorded or state.Flags.rapper or state.Flags.underground_artist) then
				return true
			end
			if state.CurrentJob and (state.CurrentJob.id or ""):lower():find("rapper") then
				return true
			end
			return false
		end,
		blockedByFlags = { first_show_done = true },
		
		choices = {
			{
				text = "Get on stage and give it everything",
				effects = { Happiness = 15 },
				setFlags = { first_show_done = true, stage_experience = true },
				feedText = "ğŸ¤ YOUR FIRST SHOW! Hands shaking, voice cracking... but the crowd FELT it! Standing ovation from 12 people!",
				onResolve = function(state)
					local roll = math.random()
					state.FameState = state.FameState or {}
					if roll < 0.3 then
						state.FameState.monthlyListeners = (state.FameState.monthlyListeners or 0) + math.random(100, 300)
						state:AddFeed("ğŸ”¥ Someone recorded it! Video got 2000 views! Local buzz building!")
					else
						state.FameState.monthlyListeners = (state.FameState.monthlyListeners or 0) + math.random(20, 80)
					end
					state.FameState.showsPerformed = 1
				end,
			},
			{
				text = "Choke and forget your lyrics",
				effects = { Happiness = -10 },
				setFlags = { first_show_done = true, stage_fright = true },
				feedText = "Disaster. You forgot everything. Stood there in silence. People laughed. Humiliating.",
			},
			{
				text = "Back out at the last second",
				effects = { Happiness = -5 },
				feedText = "You chickened out. Sat in the crowd watching others perform. Regret eating at you.",
			},
		},
	},
	{
		id = "rapper_local_collab",
		title = "ğŸ¤ Local Rapper Wants to Collab",
		emoji = "ğŸ¤",
		text = "Another underground rapper in your city reached out! They want to do a track together. They have 500 monthly listeners - bigger than you!",
		question = "How do you respond?",
		minAge = 15, maxAge = 45,
		baseChance = 0.65, -- CRITICAL FIX #521: Increased from 0.4 to 0.65
		cooldown = 1, -- CRITICAL FIX #522: Reduced from 2 to 1
		category = "career_rapper",  -- FIXED: Use career_rapper not career_music
		-- CRITICAL FIX #523: Use eligibility function instead of requiresFlags
		eligibility = function(state)
			return isRapper(state)  -- FIXED: Strict rapper check only, no fallback
		end,
		
		choices = {
			{
				text = "Absolutely! Let's make heat!",
				effects = { Happiness = 12 },
				setFlags = { has_collab = true },
				feedText = "ğŸ”¥ Collab track DROPPED! Combined fanbases! Both of you grew!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					state.FameState.monthlyListeners = (state.FameState.monthlyListeners or 0) + math.random(200, 500)
					state.FameState.collabs = (state.FameState.collabs or 0) + 1
					state.FameState.connections = (state.FameState.connections or 0) + 1
				end,
			},
			{
				text = "Only if I get to pick the beat",
				effects = { Happiness = 5 },
				feedText = "They agreed! Your choice of beat, and the track turned out fire!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					state.FameState.monthlyListeners = (state.FameState.monthlyListeners or 0) + math.random(150, 400)
					state.FameState.collabs = (state.FameState.collabs or 0) + 1
				end,
			},
			{
				text = "Nah, I'm doing this solo",
				effects = { Happiness = -3 },
				setFlags = { solo_artist = true },
				feedText = "You declined. Watching them blow up without you. Was that the right call?",
			},
		},
	},
	{
		id = "rapper_freestyle_battle",
		title = "ğŸ”¥ Freestyle Battle Challenge",
		emoji = "ğŸ”¥",
		text = "Someone at the local hip-hop meetup is calling you out! They want to battle rap. The crowd is forming a circle. Your reputation is on the line!",
		question = "What do you do?",
		minAge = 15, maxAge = 40,
		baseChance = 0.6, -- CRITICAL FIX #524: Increased from 0.35 to 0.6
		cooldown = 1, -- CRITICAL FIX #525: Reduced from 3 to 1
		category = "career_rapper",  -- FIXED: Use career_rapper not career_music
		-- CRITICAL FIX #526: Use eligibility function
		eligibility = function(state)
			return isRapper(state)  -- FIXED: Strict rapper check
		end,
		
		choices = {
			{
				text = "Accept and DESTROY them",
				effects = {},
				feedText = "Stepping into the circle...",
				onResolve = function(state)
					local smarts = (state.Stats and state.Stats.Smarts) or 50
					local roll = math.random() + (smarts / 200)
					state.FameState = state.FameState or {}
					
					if roll > 0.55 then
						state:ModifyStat("Happiness", 20)
						state.FameState.monthlyListeners = (state.FameState.monthlyListeners or 0) + math.random(300, 800)
						state.FameState.battleWins = (state.FameState.battleWins or 0) + 1
						state.Flags = state.Flags or {}
						state.Flags.battle_rapper = true
						state:AddFeed("ğŸ”¥ YOU DESTROYED THEM! The crowd went CRAZY! Video went viral locally! Legend status!")
					else
						state:ModifyStat("Happiness", -10)
						state.FameState.battleLosses = (state.FameState.battleLosses or 0) + 1
						state:AddFeed("ğŸ˜” They got you. Their punchlines hit harder. Crowd was silent. L taken.")
					end
				end,
			},
			{
				text = "Decline - that's not my style",
				effects = { Happiness = -5 },
				feedText = "You walked away. Some called you scared. Others respected it. Mixed reactions.",
			},
			{
				text = "Challenge them to drop a track instead",
				effects = { Happiness = 5, Smarts = 3 },
				feedText = "You said 'Battle raps are cool but let's see who can make a better SONG.' They agreed. Fair competition!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					state.FameState.tracksReleased = (state.FameState.tracksReleased or 1) + 1
				end,
			},
		},
	},
	
	-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
	-- LOCAL RAPPER EVENTS (1,000-10,000 monthly listeners)
	-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
	{
		id = "rapper_local_radio",
		title = "ğŸ“» Local Radio Station Interest",
		emoji = "ğŸ“»",
		text = "The local college radio station wants to play your track! This could be your first radio play!",
		question = "How do you handle this opportunity?",
		minAge = 16, maxAge = 50,
		baseChance = 0.6, -- CRITICAL FIX #527: Increased from 0.3 to 0.6
		cooldown = 4, -- CRITICAL FIX: Increased from 2 to reduce spam -- CRITICAL FIX #528: Reduced from 4 to 2
		category = "career_rapper",  -- FIXED: Use career_rapper not career_music
		-- CRITICAL FIX #529: Removed high listener requirement, just need to be a rapper
		eligibility = function(state)
			return isRapper(state)  -- FIXED: Strict rapper check only, no fallback
		end,
		
		choices = {
			{
				text = "Send them my best track",
				effects = { Happiness = 15 },
				feedText = "ğŸ“» YOUR SONG ON THE RADIO! Small station but RADIO! You recorded yourself hearing it. Legendary moment!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					state.FameState.monthlyListeners = (state.FameState.monthlyListeners or 0) + math.random(500, 1500)
					state.FameState.radioPlays = (state.FameState.radioPlays or 0) + 1
					state.Fame = (state.Fame or 0) + 3
					state.Flags = state.Flags or {}
					state.Flags.radio_played = true
				end,
			},
			{
				text = "Ask to do a live interview",
				effects = { Happiness = 12, Smarts = 3 },
				feedText = "ğŸ“» Live interview on college radio! Talked about your journey. Very authentic! New fans incoming!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					state.FameState.monthlyListeners = (state.FameState.monthlyListeners or 0) + math.random(800, 2000)
					state.Fame = (state.Fame or 0) + 5
				end,
			},
		},
	},
	{
		id = "rapper_first_paid_show",
		title = "ğŸ’° First Paid Performance Offer",
		emoji = "ğŸ’°",
		text = "A local club wants you to perform! They're offering $200 for a 20-minute set. This is PAID WORK as a rapper!",
		question = "Do you take the gig?",
		minAge = 18, maxAge = 50,
		baseChance = 0.6, -- CRITICAL FIX #530: Increased from 0.35 to 0.6
		cooldown = 1, -- CRITICAL FIX #531: Reduced from 3 to 1
		category = "career_rapper",  -- FIXED: Use career_rapper not career_music
		-- CRITICAL FIX #532: Loosened requirements - just need to be a rapper
		eligibility = function(state)
			return isRapper(state) or (state.Flags and (state.Flags.first_show_done or state.Flags.stage_experience or state.Flags.first_track_recorded))
		end,
		
		choices = {
			{
				text = "Take the bag and perform",
				effects = { Happiness = 15, Money = 200 },
				setFlags = { paid_performer = true },
				feedText = "ğŸ’° $200 for rapping! You're a PROFESSIONAL now! Crowd was hype!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					state.FameState.showsPerformed = (state.FameState.showsPerformed or 0) + 1
					state.FameState.totalEarnings = (state.FameState.totalEarnings or 0) + 200
					state.FameState.monthlyListeners = (state.FameState.monthlyListeners or 0) + math.random(100, 400)
				end,
			},
			{
				text = "Negotiate for $300",
				effects = {},
				feedText = "Negotiating...",
				onResolve = function(state)
					local roll = math.random()
					if roll < 0.4 then
						state.Money = (state.Money or 0) + 300
						state:ModifyStat("Happiness", 18)
						state:AddFeed("ğŸ’° They said YES! $300 for 20 minutes! Know your worth!")
						state.FameState = state.FameState or {}
						state.FameState.totalEarnings = (state.FameState.totalEarnings or 0) + 300
					else
						state:ModifyStat("Happiness", -5)
						state:AddFeed("They passed. Went with someone cheaper. Missed opportunity.")
					end
				end,
			},
			{
				text = "Decline - $200 is insulting",
				effects = { Happiness = -3 },
				feedText = "You turned it down. Pride over payment. Questionable at this stage...",
			},
		},
	},
	{
		id = "rapper_blog_feature",
		title = "ğŸ“ Hip-Hop Blog Wants to Feature You",
		emoji = "ğŸ“",
		text = "A popular underground hip-hop blog reached out! They want to write about you and premiere your next track. This could be HUGE for exposure!",
		question = "How do you respond?",
		minAge = 16, maxAge = 50,
		baseChance = 0.55, -- CRITICAL FIX #533: Increased from 0.25 to 0.55
		cooldown = 4, -- CRITICAL FIX: Increased from 2 to reduce spam -- CRITICAL FIX #534: Reduced from 5 to 2
		category = "career_rapper",  -- FIXED: Use career_rapper not career_music
		-- CRITICAL FIX #535: Loosened requirements - just need rapper status
		eligibility = function(state)
			return isRapper(state)  -- FIXED: Strict rapper check only, no fallback
		end,
		
		choices = {
			{
				text = "Give them an exclusive premiere",
				effects = { Happiness = 18 },
				setFlags = { blog_featured = true },
				feedText = "ğŸ“ FEATURE DROPPED! Blog wrote a whole article about you! 'Rising Underground Talent' - credibility BOOST!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					state.FameState.monthlyListeners = (state.FameState.monthlyListeners or 0) + math.random(2000, 5000)
					state.FameState.blogFeatures = (state.FameState.blogFeatures or 0) + 1
					state.Fame = (state.Fame or 0) + 5
				end,
			},
			{
				text = "Do an interview for the feature",
				effects = { Happiness = 15, Smarts = 2 },
				feedText = "ğŸ“ Full interview published! Talked about your story. People connecting with you on a deeper level!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					state.FameState.monthlyListeners = (state.FameState.monthlyListeners or 0) + math.random(3000, 7000)
					state.Fame = (state.Fame or 0) + 7
				end,
			},
		},
	},
	{
		id = "rapper_mixtape_release",
		title = "ğŸ“€ Time to Drop a Mixtape",
		emoji = "ğŸ“€",
		text = "You've got enough tracks for a full project. Time to put together a mixtape and drop it!",
		question = "What kind of project do you release?",
		minAge = 16, maxAge = 50,
		baseChance = 0.65, -- CRITICAL FIX #538: Increased from 0.4 to 0.65
		cooldown = 4, -- CRITICAL FIX: Increased from 2 to reduce spam -- CRITICAL FIX #539: Reduced from 5 to 2
		oneTime = false,
		maxOccurrences = 10, -- CRITICAL FIX #540: Increased from 5 to 10
		category = "career_rapper",  -- FIXED: Use career_rapper not career_music
		-- CRITICAL FIX #541: Loosened eligibility - just need rapper status
		eligibility = function(state)
			return isRapper(state)  -- FIXED: Strict rapper check only, no fallback
		end,
		
		choices = {
			{
				text = "Raw street mixtape - 15 tracks ($200)",
				-- CRITICAL FIX: Moved Money to onResolve to prevent negative
				effects = { Happiness = 20 },
				setFlags = { has_mixtape = true },
				feedText = "ğŸ“€ MIXTAPE DROPPED! 15 tracks of raw heat! Underground forums going crazy!",
				-- CRITICAL FIX: Add eligibility check
				eligibility = function(state)
					if (state.Money or 0) < 200 then
						return false, "Need $200 for production costs"
					end
					return true
				end,
				onResolve = function(state)
					-- CRITICAL FIX: Deduct money safely here
					state.Money = math.max(0, (state.Money or 0) - 200)
					state.FameState = state.FameState or {}
					local boost = math.random(3000, 8000)
					state.FameState.monthlyListeners = (state.FameState.monthlyListeners or 0) + boost
					state.FameState.mixtapesReleased = (state.FameState.mixtapesReleased or 0) + 1
					state.Fame = (state.Fame or 0) + 8
					state:AddFeed(string.format("ğŸ“€ Mixtape did %d streams first week! Building momentum!", boost * 5))
				end,
			},
			{
				text = "Quality EP - 7 polished tracks ($500)",
				-- CRITICAL FIX: Moved Money to onResolve to prevent negative
				effects = { Happiness = 18 },
				-- CRITICAL FIX: Add eligibility check
				eligibility = function(state)
					if (state.Money or 0) < 500 then
						return false, "Need $500 for production costs"
					end
					return true
				end,
				setFlags = { has_ep = true },
				feedText = "ğŸ“€ EP RELEASED! Shorter but every track is HEAT! Quality over quantity approach!",
				onResolve = function(state)
					-- CRITICAL FIX: Deduct money safely here
					state.Money = math.max(0, (state.Money or 0) - 500)
					state.FameState = state.FameState or {}
					local boost = math.random(4000, 10000)
					state.FameState.monthlyListeners = (state.FameState.monthlyListeners or 0) + boost
					state.FameState.epsReleased = (state.FameState.epsReleased or 0) + 1
					state.Fame = (state.Fame or 0) + 10
				end,
			},
			{
				text = "Wait until everything is perfect",
				effects = { Happiness = -5 },
				feedText = "Perfectionism is killing your momentum. Other artists dropping while you're sitting on unreleased music.",
			},
		},
	},
	
	-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
	-- REGIONAL BUZZ EVENTS (10,000-100,000 monthly listeners)
	-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
	{
		id = "rapper_label_interest",
		title = "ğŸ¢ Record Label Reaching Out!",
		emoji = "ğŸ¢",
		text = "An A&R from a mid-sized label sent you a DM! They've been watching your growth and want to have a conversation about 'opportunities.'",
		question = "How do you respond?",
		minAge = 18, maxAge = 50,
		baseChance = 0.5, -- CRITICAL FIX #542: Increased from 0.2 to 0.5
		cooldown = 4, -- CRITICAL FIX: Increased from 2 to reduce spam -- CRITICAL FIX #543: Reduced from 6 to 2
		category = "career_rapper",  -- FIXED: Use career_rapper not career_music
		-- CRITICAL FIX #544: Loosened eligibility - rappers can get label interest
		eligibility = function(state)
			return isRapper(state) or (state.Flags and (state.Flags.has_mixtape or state.Flags.has_ep or state.Flags.first_track_recorded))
		end,
		
		choices = {
			{
				text = "Take the meeting, hear them out",
				effects = { Happiness = 15, Smarts = 5 },
				feedText = "ğŸ¢ Met with the A&R! They're interested but want to see more growth first. Door is OPEN!",
				onResolve = function(state)
					state.Flags = state.Flags or {}
					state.Flags.label_interested = true
					state.FameState = state.FameState or {}
					state.FameState.labelMeetings = (state.FameState.labelMeetings or 0) + 1
				end,
			},
			{
				text = "Bring a lawyer to negotiate",
				effects = { Happiness = 10, Smarts = 8, Money = -500 },
				setFlags = { smart_about_business = true },
				feedText = "ğŸ¢ Lawyer reviewed their offer. Found red flags! Avoided a bad deal. Knowledge is power!",
			},
			{
				text = "Stay independent - labels are vultures",
				effects = { Happiness = 5 },
				setFlags = { fiercely_independent = true },
				feedText = "You declined. Some say you're smart. Others say you're letting ego block opportunity. Only time will tell.",
			},
			-- â­ CELEBRITY PREMIUM OPTION
			{
				text = "â­ [Celebrity] Leverage for a MAJOR deal",
				effects = { Happiness = 25, Money = 50000 },
				requiresGamepass = "CELEBRITY",
				gamepassEmoji = "â­",
				feedText = "â­ Celebrity gamepass! You got a MAJOR label deal! $50K advance! Your career just changed FOREVER!",
				setFlags = { signed_to_label = true, major_deal = true },
				onResolve = function(state)
					state.FameState = state.FameState or {}
					state.FameState.monthlyListeners = (state.FameState.monthlyListeners or 0) + 50000
					state.Fame = (state.Fame or 0) + 25
					state.CurrentJob = state.CurrentJob or {}
					state.CurrentJob.name = "Signed Rapper"
					state.CurrentJob.salary = 75000
				end,
			},
		},
	},
	{
		id = "rapper_bigger_artist_feature",
		title = "ğŸŒŸ Big Artist Wants You on Their Track!",
		emoji = "ğŸŒŸ",
		-- CRITICAL FIX #USER-33: Use getDynamicText to dynamically show an artist BIGGER than you!
		getDynamicText = function(state)
			local myListeners = state.FameState and state.FameState.monthlyListeners or 0
			-- Calculate a bigger artist (2x to 5x your listeners, minimum 50K)
			local biggerArtist = math.max(50000, math.floor(myListeners * math.random(20, 50) / 10))
			-- Format with K/M
			local formattedListeners
			if biggerArtist >= 1000000 then
				formattedListeners = string.format("%.1fM", biggerArtist / 1000000)
			else
				formattedListeners = string.format("%dK", math.floor(biggerArtist / 1000))
			end
			return { text = string.format("A rapper with %s monthly listeners reached out! They heard your music and want you on their next single. This is MAJOR exposure!", formattedListeners) }
		end,
		text = "A bigger artist reached out! They heard your music and want you on their next single. This is MAJOR exposure!",
		question = "What do you do?",
		minAge = 18, maxAge = 50,
		baseChance = 0.35,
		cooldown = 4,
		maxOccurrences = 3,
		category = "career_rapper",
		-- CRITICAL FIX #USER-33: Require real progression before big collabs
		eligibility = function(state)
			if not isRapper(state) then return false end
			local flags = state.Flags or {}
			local hasProgression = flags.did_first_show or flags.has_mixtape or flags.has_ep or 
				flags.local_fame or flags.buzz or flags.did_local_show
			local listeners = state.FameState and state.FameState.monthlyListeners or 0
			return hasProgression or listeners >= 10000
		end,
		
		choices = {
			{
				text = "Record an INSANE verse",
				effects = { Happiness = 25 },
				setFlags = { major_feature = true },
				feedText = "ğŸŒŸ YOUR VERSE WENT CRAZY! Everyone saying you STOLE the song! Career-defining moment!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					-- Scale boost based on current size
					local currentListeners = state.FameState.monthlyListeners or 0
					local boost = math.max(30000, math.floor(currentListeners * 0.5) + math.random(20000, 50000))
					state.FameState.monthlyListeners = currentListeners + boost
					state.Fame = (state.Fame or 0) + 15
					state.FameState.majorFeatures = (state.FameState.majorFeatures or 0) + 1
					state:AddFeed(string.format("ğŸŒŸ Feature dropped! You gained %d new listeners! HUGE W!", boost))
				end,
			},
			{
				text = "Play it safe - don't outshine them",
				effects = { Happiness = 10 },
				feedText = "Solid verse but you held back. Some fans noticed. 'Should've went harder.' Missed opportunity to shine.",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					local currentListeners = state.FameState.monthlyListeners or 0
					local boost = math.max(10000, math.floor(currentListeners * 0.2) + math.random(5000, 15000))
					state.FameState.monthlyListeners = currentListeners + boost
					state.Fame = (state.Fame or 0) + 7
				end,
			},
		},
	},
	{
		id = "rapper_viral_moment",
		title = "ğŸ“± YOUR SONG IS GOING VIRAL!",
		emoji = "ğŸ“±",
		text = "Someone used your track in a TikTok and it BLEW UP! 10 million views! Your streams are EXPLODING!",
		question = "How do you capitalize?",
		minAge = 16, maxAge = 50,
		baseChance = 0.4,
		cooldown = 4, -- CRITICAL FIX: Increased from 2 to reduce spam
		oneTime = false,
		maxOccurrences = 5,
		category = "career_rapper",
		eligibility = function(state)
			return isRapper(state)
		end,
		
		choices = {
			{
				text = "Drop content immediately - ride the wave!",
				effects = { Happiness = 30 },
				feedText = "ğŸ“± PERFECT TIMING! You dropped new music during the viral moment! Converted TikTokers into real fans!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					local boost = math.random(50000, 150000)
					local newListeners = (state.FameState.monthlyListeners or 0) + boost
					state.FameState.monthlyListeners = newListeners
					state.Fame = (state.Fame or 0) + 25
					state.FameState.viralMoments = (state.FameState.viralMoments or 0) + 1
					state.Money = (state.Money or 0) + math.random(5000, 20000)
					
					-- CRITICAL FIX #USER-32: UPDATE JOB TITLE based on new listener count!
					-- This is the KEY fix - going viral should upgrade your career!
					state.CurrentJob = state.CurrentJob or {}
					if newListeners >= 500000 then
						state.CurrentJob.name = "Hot Rapper"
						state.CurrentJob.salary = math.max(state.CurrentJob.salary or 0, 500000)
						state.Flags = state.Flags or {}
						state.Flags.charting_artist = true
						state.Flags.hit_maker = true
						state:AddFeed(string.format("ğŸ“± VIRAL SUCCESS! You gained %d listeners and you're now a HOT RAPPER! ğŸ”¥", boost))
					elseif newListeners >= 100000 then
						state.CurrentJob.name = "Buzzing Rapper"
						state.CurrentJob.salary = math.max(state.CurrentJob.salary or 0, 25000)
						state.Flags = state.Flags or {}
						state.Flags.buzz = true
						state.Flags.viral_potential = true
						state:AddFeed(string.format("ğŸ“± VIRAL SUCCESS! You gained %d listeners! You're BUZZING now! ğŸ”Š", boost))
					elseif newListeners >= 25000 then
						state.CurrentJob.name = "Local Rapper"
						state.CurrentJob.salary = math.max(state.CurrentJob.salary or 0, 3000)
						state.Flags = state.Flags or {}
						state.Flags.local_fame = true
						state:AddFeed(string.format("ğŸ“± VIRAL SUCCESS! You gained %d listeners! Local fame incoming!", boost))
					else
						state:AddFeed(string.format("ğŸ“± You gained %d new monthly listeners! VIRAL SUCCESS!", boost))
					end
				end,
			},
			{
				text = "Do live streams to connect with new fans",
				effects = { Happiness = 25 },
				feedText = "ğŸ“± Went live! Thousands watching! Personal connection made! Loyal fanbase building!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					local boost = math.random(40000, 100000)
					local newListeners = (state.FameState.monthlyListeners or 0) + boost
					state.FameState.monthlyListeners = newListeners
					state.Fame = (state.Fame or 0) + 20
					
					-- CRITICAL FIX #USER-32: Also update job for this choice
					state.CurrentJob = state.CurrentJob or {}
					if newListeners >= 100000 and (state.CurrentJob.name or ""):lower():find("underground") then
						state.CurrentJob.name = "Buzzing Rapper"
						state.CurrentJob.salary = math.max(state.CurrentJob.salary or 0, 25000)
						state.Flags = state.Flags or {}
						state.Flags.buzz = true
					end
				end,
			},
			{
				text = "Stay mysterious - let the music speak",
				effects = { Happiness = 10 },
				feedText = "Mysterious approach. Some fans intrigued. Others moved on. Could've capitalized harder.",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					state.FameState.monthlyListeners = (state.FameState.monthlyListeners or 0) + math.random(15000, 40000)
					state.Fame = (state.Fame or 0) + 10
				end,
			},
		},
	},
	
	-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
	-- HOT RAPPER EVENTS (100K-500K monthly listeners)
	-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
	{
		id = "rapper_first_album",
		title = "ğŸ’¿ Time for Your Debut ALBUM",
		emoji = "ğŸ’¿",
		text = "You've built enough buzz. It's time to drop a full ALBUM. This is the next level. Major investment needed.",
		question = "What's your album strategy?",
		minAge = 18, maxAge = 50,
		baseChance = 0.5, -- CRITICAL FIX #571: Increased from 0.3 to 0.5
		cooldown = 3, -- CRITICAL FIX #572: Reduced from 10 to 3
		oneTime = false, -- CRITICAL FIX #573: Changed to allow multiple albums
		maxOccurrences = 5,
		category = "career_rapper",  -- FIXED: Use career_rapper not career_music
		-- CRITICAL FIX #574: Loosened eligibility - just need to be a rapper
		eligibility = function(state)
			return isRapper(state) or (state.Flags and (state.Flags.has_mixtape or state.Flags.has_ep))
		end,
		
		choices = {
			{
				text = "Go all out - $50K production budget",
				effects = { Happiness = 30, Money = -50000 },
				setFlags = { debut_album = true },
				feedText = "ğŸ’¿ ALBUM DROPPED! World-class production! Critics calling it 'impressive debut!' Career ELEVATED!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					state.FameState.monthlyListeners = (state.FameState.monthlyListeners or 0) + math.random(100000, 300000)
					state.FameState.albumsReleased = (state.FameState.albumsReleased or 0) + 1
					state.Fame = (state.Fame or 0) + 30
					state.Money = (state.Money or 0) + math.random(50000, 150000) -- Album sales/streams
				end,
			},
			{
				text = "DIY approach - $5K budget, raw sound",
				effects = { Happiness = 20, Money = -5000 },
				setFlags = { debut_album = true, diy_artist = true },
				feedText = "ğŸ’¿ ALBUM DROPPED! Raw, authentic sound! Underground heads LOVE IT! Mainstream confused but cult following growing!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					state.FameState.monthlyListeners = (state.FameState.monthlyListeners or 0) + math.random(50000, 120000)
					state.FameState.albumsReleased = (state.FameState.albumsReleased or 0) + 1
					state.Fame = (state.Fame or 0) + 20
				end,
			},
		},
	},
	{
		id = "rapper_beef",
		title = "ğŸ˜¤ RAP BEEF STARTING!",
		emoji = "ğŸ˜¤",
		text = "Another rapper dissed you in an interview! They called your music 'mid' and said you're 'overrated.' The internet is waiting for your response!",
		question = "How do you respond?",
		minAge = 18, maxAge = 50,
		baseChance = 0.5, -- CRITICAL FIX #575: Increased from 0.25 to 0.5
		cooldown = 4, -- CRITICAL FIX: Increased from 2 to reduce spam -- CRITICAL FIX #576: Reduced from 5 to 2
		category = "career_rapper",  -- FIXED: Use career_rapper not career_music
		-- CRITICAL FIX #577: Loosened eligibility - any rapper can get into beef
		eligibility = function(state)
			return isRapper(state)
		end,
		
		choices = {
			{
				text = "DROP A DISS TRACK IMMEDIATELY",
				effects = {},
				feedText = "Recording diss track...",
				onResolve = function(state)
					local smarts = (state.Stats and state.Stats.Smarts) or 50
					local roll = math.random() + (smarts / 200)
					state.FameState = state.FameState or {}
					
					if roll > 0.5 then
						state:ModifyStat("Happiness", 30)
						state.FameState.monthlyListeners = (state.FameState.monthlyListeners or 0) + math.random(50000, 150000)
						state.Fame = (state.Fame or 0) + 20
						state:AddFeed("ğŸ˜¤ DISS TRACK OF THE YEAR! You ENDED them! Everyone saying you WON! Career high!")
					else
						state:ModifyStat("Happiness", -15)
						state.FameState.monthlyListeners = math.max(0, (state.FameState.monthlyListeners or 0) - math.random(10000, 30000))
						state:AddFeed("ğŸ˜¤ Your diss track was MID. They responded and it was BETTER. You took an L.")
					end
				end,
			},
			{
				text = "Stay quiet - don't give them attention",
				effects = { Happiness = 5, Smarts = 5 },
				feedText = "Mature response. Some respect it. Others wanted smoke. The beef died down.",
			},
			{
				text = "Address it in an interview - no track",
				effects = { Happiness = 10 },
				feedText = "Spoke on it calmly. Made them look childish. Handled it with class.",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					state.FameState.monthlyListeners = (state.FameState.monthlyListeners or 0) + math.random(10000, 30000)
				end,
			},
		},
	},
	{
		id = "rapper_tour_offer",
		title = "ğŸ¤ TOUR OPPORTUNITY!",
		emoji = "ğŸ¤",
		text = "A promoter wants you to do a 15-city tour! Opening for a bigger artist. This is MAJOR but grueling.",
		question = "Do you take the tour?",
		minAge = 18, maxAge = 50,
		baseChance = 0.45,
		cooldown = 3,
		category = "career_rapper",  -- FIXED: Use career_rapper not career_music
		-- REMOVED isCelebrityOnly - Tours happen to growing rappers!
		-- CRITICAL FIX #509: Use isRapper helper
		eligibility = function(state)
			if not isRapper(state) then return false end
			local listeners = state.FameState and state.FameState.monthlyListeners or 0
			return listeners >= 75000, "Need bigger fanbase for tour"
		end,
		
		choices = {
			{
				text = "Let's GO! 15 cities!",
				effects = { Happiness = 25, Health = -15, Money = 30000 },
				setFlags = { has_toured = true },
				feedText = "ğŸ¤ TOUR COMPLETE! 15 cities! Exhausting but INCREDIBLE! New fans in every city! Legend status building!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					state.FameState.monthlyListeners = (state.FameState.monthlyListeners or 0) + math.random(80000, 200000)
					state.Fame = (state.Fame or 0) + 25
					state.FameState.toursCompleted = (state.FameState.toursCompleted or 0) + 1
				end,
			},
			{
				text = "Negotiate for HEADLINER status",
				effects = {},
				feedText = "Negotiating...",
				onResolve = function(state)
					local roll = math.random()
					if roll < 0.3 then
						state.Money = (state.Money or 0) + 75000
						state:ModifyStat("Happiness", 35)
						state:ModifyStat("Health", -20)
						state.FameState = state.FameState or {}
						state.FameState.monthlyListeners = (state.FameState.monthlyListeners or 0) + math.random(150000, 350000)
						state.Fame = (state.Fame or 0) + 35
						state:AddFeed("ğŸ¤ HEADLINER TOUR! YOUR NAME ON THE MARQUEE! This is SUPERSTAR level!")
					else
						state:ModifyStat("Happiness", -5)
						state:AddFeed("They passed. Went with someone more established. Humbling.")
					end
				end,
			},
		},
	},
	
	-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
	-- MAINSTREAM RAPPER EVENTS (500K-5M monthly listeners)
	-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
	{
		id = "rapper_platinum",
		title = "ğŸ’ YOUR SONG WENT PLATINUM!",
		emoji = "ğŸ’",
		text = "1 MILLION copies sold! Your single is officially PLATINUM! This is elite status!",
		question = "How do you celebrate?",
		minAge = 18, maxAge = 60,
		baseChance = 0.4,
		cooldown = 5,
		oneTime = true,
		category = "career_rapper",  -- FIXED: Use career_rapper not career_music
		-- REMOVED isCelebrityOnly - Platinum can happen to any rapper!
		-- CRITICAL FIX #509: Use isRapper helper
		eligibility = function(state)
			if not isRapper(state) then return false end
			local listeners = state.FameState and state.FameState.monthlyListeners or 0
			return listeners >= 500000, "Need 500K+ listeners for platinum"
		end,
		
		choices = {
			{
				text = "Throw a MASSIVE party",
				effects = { Happiness = 40, Money = -20000, Health = -5 },
				setFlags = { platinum_artist = true },
				feedText = "ğŸ’ PLATINUM PARTY! A-list guests! You're officially in the elite club! LEGENDARY!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					state.FameState.platinumRecords = (state.FameState.platinumRecords or 0) + 1
					state.Fame = (state.Fame or 0) + 40
					state.Money = (state.Money or 0) + 500000 -- Platinum bonus
					state.CurrentJob = state.CurrentJob or {}
					state.CurrentJob.name = "Platinum Rapper"
					state.CurrentJob.salary = 500000
				end,
			},
			{
				text = "Stay humble - back to the studio",
				effects = { Happiness = 25, Smarts = 5 },
				setFlags = { platinum_artist = true, humble_star = true },
				feedText = "ğŸ’ Celebrated quietly. Back to work. People respect the humility. Building a legacy, not just moments.",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					state.FameState.platinumRecords = (state.FameState.platinumRecords or 0) + 1
					state.Fame = (state.Fame or 0) + 35
					state.Money = (state.Money or 0) + 500000
				end,
			},
		},
	},
	{
		id = "rapper_grammy_nom",
		title = "ğŸ† GRAMMY NOMINATION!",
		emoji = "ğŸ†",
		text = "You've been NOMINATED for a GRAMMY! Best New Artist! The biggest award in music!",
		question = "How do you prepare?",
		minAge = 18, maxAge = 60,
		baseChance = 0.1,
		cooldown = 6,
		oneTime = true,
		category = "career_rapper",  -- FIXED: Use career_rapper not career_music
		isCelebrityOnly = true,
		-- CRITICAL FIX #MOBILE-16: STRICT eligibility - ONLY for established rappers with high fame
		eligibility = function(state)
			local fame = state.Fame or 0
			-- Must have at least 50 fame (Famous level)
			if fame < 50 then
				return false, "Need significant fame (50+) for Grammy nomination"
			end
			-- Must be a RAPPER, not a streamer/creator
			local isActualRapper = false
			if state.CurrentJob then
				local jobId = (state.CurrentJob.id or ""):lower()
				if jobId:find("rapper") then
					isActualRapper = true
				end
			end
			if state.Flags and (state.Flags.rapper or state.Flags.signed_artist or state.Flags.charting_artist) then
				isActualRapper = true
			end
			-- BLOCK if player is a streamer/creator (not a rapper)
			if state.CurrentJob then
				local jobId = (state.CurrentJob.id or ""):lower()
				if jobId:find("streamer") or jobId:find("creator") or jobId:find("youtuber") or jobId:find("influencer") then
					if not isActualRapper then
						return false, "Grammy nominations are for musicians, not content creators"
					end
				end
			end
			return isActualRapper, "Must be a rapper with music career"
		end,
		
		choices = {
			{
				text = "Attend and WIN!",
				effects = {},
				feedText = "Grammy night...",
				onResolve = function(state)
					local roll = math.random()
					state.FameState = state.FameState or {}
					
					if roll < 0.25 then
						state:ModifyStat("Happiness", 50)
						state.FameState.grammyWins = (state.FameState.grammyWins or 0) + 1
						state.Fame = 100 -- MAX FAME
						state.Money = (state.Money or 0) + 1000000
						state.Flags = state.Flags or {}
						state.Flags.grammy_winner = true
						state:AddFeed("ğŸ† YOU WON A GRAMMY!!! Speech was legendary! You're an ICON now!")
						state.CurrentJob = state.CurrentJob or {}
						state.CurrentJob.name = "Grammy-Winning Rapper"
						state.CurrentJob.salary = 2000000
					else
						state:ModifyStat("Happiness", 15)
						state.FameState.grammyNominations = (state.FameState.grammyNominations or 0) + 1
						state:AddFeed("ğŸ† Didn't win but the nomination ITSELF is legendary. Next year!")
					end
				end,
			},
			{
				text = "Skip the Grammys - awards don't matter",
				effects = { Happiness = 5 },
				setFlags = { anti_establishment = true },
				feedText = "Controversial move. Some call you real. Others say you're scared to lose. Bold statement.",
			},
		},
	},
	
	-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
	-- CONTENT CREATOR EVENTS - YouTuber/Streamer/Influencer
	-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
	{
		id = "creator_first_video",
		title = "ğŸ“¹ Starting Your Channel",
		emoji = "ğŸ“¹",
		text = "You finally set up your YouTube/TikTok channel. Time to post your first video!",
		question = "What kind of content do you make?",
		minAge = 13, maxAge = 55,  -- CRITICAL FIX #620: Extended max age
		baseChance = 1.0,  -- CRITICAL FIX #621: GUARANTEED trigger
		cooldown = 0,  -- CRITICAL FIX #622: No cooldown for foundation event
		oneTime = true,
		priority = "high",  -- CRITICAL FIX #623: High priority
		isMilestone = true,  -- CRITICAL FIX #624: Treat as milestone
		category = "career_creative",
		-- CRITICAL FIX #625: Better eligibility check for content creators
		eligibility = function(state)
			-- Check job first
			if state.CurrentJob then
				local jobId = (state.CurrentJob.id or ""):lower()
				local jobName = (state.CurrentJob.name or ""):lower()
				if jobId:find("creator") or jobId:find("streamer") or jobId:find("youtuber") or jobId:find("influencer") then
					return true
				end
				if jobName:find("creator") or jobName:find("streamer") or jobName:find("youtuber") then
					return true
				end
			end
			-- Check flags
			local flags = state.Flags or {}
			if flags.pursuing_streaming or flags.pursuing_influencer or flags.pursuing_content 
			   or flags.content_creator or flags.streamer or flags.youtuber then
				return true
			end
			return false
		end,
		blockedByFlags = { first_video_posted = true },
		
		choices = {
			{
				text = "Gaming content - Let's Plays",
				effects = { Happiness = 10 },
				setFlags = { first_video_posted = true, gaming_creator = true },
				feedText = "ğŸ“¹ First video posted! Gaming content. 47 views. Everyone starts somewhere!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					-- CRITICAL FIX: Set careerPath so FameState gets serialized!
					state.FameState.careerPath = state.FameState.careerPath or "streamer"
					state.FameState.isFamous = true
					state.FameState.subscribers = math.random(5, 50)
					state.FameState.totalViews = math.random(30, 200)
					state.FameState.totalVideos = 1
					state.FameState.contentType = "gaming"
					state.Fame = (state.Fame or 0) + 1
				end,
			},
			{
				text = "Vlogs - Daily life content",
				effects = { Happiness = 10 },
				setFlags = { first_video_posted = true, vlog_creator = true },
				feedText = "ğŸ“¹ First vlog posted! Showing your life. Authentic! 32 views. The journey begins!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					-- CRITICAL FIX: Set careerPath so FameState gets serialized!
					state.FameState.careerPath = state.FameState.careerPath or "youtuber"
					state.FameState.isFamous = true
					state.FameState.subscribers = math.random(5, 50)
					state.FameState.totalViews = math.random(30, 200)
					state.FameState.totalVideos = 1
					state.FameState.contentType = "vlogs"
					state.Fame = (state.Fame or 0) + 1
				end,
			},
			{
				text = "Educational/Tutorial content",
				effects = { Happiness = 10, Smarts = 3 },
				setFlags = { first_video_posted = true, educational_creator = true },
				feedText = "ğŸ“¹ First tutorial posted! Teaching what you know. 89 views! Helpful content finds an audience!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					-- CRITICAL FIX: Set careerPath so FameState gets serialized!
					state.FameState.careerPath = state.FameState.careerPath or "youtuber"
					state.FameState.isFamous = true
					state.FameState.subscribers = math.random(10, 100)
					state.FameState.totalViews = math.random(50, 300)
					state.FameState.totalVideos = 1
					state.FameState.contentType = "educational"
					state.Fame = (state.Fame or 0) + 1
				end,
			},
			{
				text = "Comedy/Entertainment skits",
				effects = { Happiness = 12 },
				setFlags = { first_video_posted = true, comedy_creator = true },
				feedText = "ğŸ“¹ First skit posted! Making people laugh. 156 views! Comedy travels!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					-- CRITICAL FIX: Set careerPath so FameState gets serialized!
					state.FameState.careerPath = state.FameState.careerPath or "youtuber"
					state.FameState.isFamous = true
					state.FameState.subscribers = math.random(15, 150)
					state.FameState.totalViews = math.random(100, 500)
					state.FameState.totalVideos = 1
					state.FameState.contentType = "comedy"
					state.Fame = (state.Fame or 0) + 1
				end,
			},
		},
	},
	{
		id = "creator_consistency_grind",
		title = "ğŸ“… The Consistency Grind",
		emoji = "ğŸ“…",
		text = "Success on social media requires CONSISTENCY. You need to post regularly. It's exhausting but necessary.",
		question = "How do you approach your upload schedule?",
		minAge = 13, maxAge = 50,
		baseChance = 0.5,
		cooldown = 4, -- CRITICAL FIX: Increased from 2 to reduce spam
		category = "career_creative",
		-- CRITICAL FIX: Must be an actual content creator, not just have flags
		eligibility = function(state)
			-- First verify player is actually a content creator by job
			if not isContentCreator(state) then
				return false, "This event is only for content creators"
			end
			local flags = state.Flags or {}
			return flags.first_video_posted or flags.content_creator or flags.pursuing_streaming
		end,
		
		choices = {
			{
				text = "Daily uploads - ALL IN",
				effects = { Happiness = -5, Health = -10 },
				setFlags = { daily_uploader = true },
				feedText = "ğŸ“… 30 days straight! Exhausting but the algorithm LOVES consistency! Growth accelerating!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					state.FameState.subscribers = (state.FameState.subscribers or 0) + math.random(500, 2000)
					state.FameState.totalViews = (state.FameState.totalViews or 0) + math.random(5000, 20000)
					-- CRITICAL FIX: Track video count - daily uploads = 30 videos/month
					state.FameState.totalVideos = (state.FameState.totalVideos or 0) + 30
				end,
			},
			{
				text = "Weekly schedule - sustainable pace",
				effects = { Happiness = 5, Health = -2 },
				feedText = "ğŸ“… Weekly uploads. Sustainable. Quality stays high. Slow but steady growth!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					state.FameState.subscribers = (state.FameState.subscribers or 0) + math.random(200, 800)
					state.FameState.totalViews = (state.FameState.totalViews or 0) + math.random(2000, 8000)
					-- CRITICAL FIX: Track video count - weekly = 4 videos/month
					state.FameState.totalVideos = (state.FameState.totalVideos or 0) + 4
				end,
			},
			{
				text = "When inspiration hits - sporadic",
				effects = { Happiness = 8 },
				feedText = "ğŸ“… Posting when you feel like it. Algorithm isn't happy. Growth is slow. But you're not burnt out!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					state.FameState.subscribers = (state.FameState.subscribers or 0) + math.random(50, 300)
					-- CRITICAL FIX: Track video count - sporadic = 1-2 videos
					state.FameState.totalVideos = (state.FameState.totalVideos or 0) + math.random(1, 2)
				end,
			},
		},
	},
	{
		id = "creator_first_1k",
		title = "ğŸ‰ 1,000 SUBSCRIBERS!",
		emoji = "ğŸ‰",
		text = "You hit 1,000 subscribers! A HUGE milestone! You can now apply for monetization!",
		question = "How do you celebrate?",
		minAge = 13, maxAge = 50,
		baseChance = 0.4,
		cooldown = 4, -- CRITICAL FIX: Increased from 2 to reduce spam
		oneTime = true,
		category = "career_creative",
		requiresFlags = { first_video_posted = true },
		-- CRITICAL FIX: Must be an actual content creator, not just have flags
		eligibility = function(state)
			if not isContentCreator(state) then
				return false, "This event is only for content creators"
			end
			local subs = state.FameState and state.FameState.subscribers or 0
			return subs >= 1000, "Need 1000 subscribers first"
		end,
		
		choices = {
			{
				text = "Special thank you video to fans",
				effects = { Happiness = 20 },
				setFlags = { monetization_eligible = true },
				feedText = "ğŸ‰ Thank you video! Your community feels appreciated! Real connection building!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					state.FameState.subscribers = (state.FameState.subscribers or 0) + math.random(200, 500)
					-- CRITICAL FIX: Track video count
					state.FameState.totalVideos = (state.FameState.totalVideos or 0) + 1
				end,
			},
			{
				text = "Apply for YouTube Partner Program",
				effects = { Happiness = 15, Money = 100 },
				setFlags = { monetized = true, youtube_partner = true },
				feedText = "ğŸ‰ MONETIZED! First ad revenue: $100! Not much but it's SOMETHING! The dream is REAL!",
				onResolve = function(state)
					state.CurrentJob = state.CurrentJob or {}
					state.CurrentJob.name = "Content Creator (Monetized)"
					state.CurrentJob.salary = 3000 -- Starting low
				end,
			},
		},
	},
	{
		id = "creator_viral_video",
		title = "ğŸ”¥ YOUR VIDEO WENT VIRAL!",
		emoji = "ğŸ”¥",
		text = "One of your videos EXPLODED! 5 million views and counting! Your phone won't stop buzzing with notifications!",
		question = "How do you handle sudden fame?",
		minAge = 13, maxAge = 50,
		baseChance = 0.32,
		cooldown = 4,
		oneTime = false,
		maxOccurrences = 5,
		category = "career_creative",
		-- REMOVED isCelebrityOnly - Viral videos can happen to any creator!
		requiresFlags = { first_video_posted = true },
		-- CRITICAL FIX: Must be an actual content creator, not just have flags
		eligibility = function(state)
			if not isContentCreator(state) then
				return false, "This event is only for content creators"
			end
			return true
		end,
		
		choices = {
			{
				text = "Strike while iron is hot - post MORE!",
				effects = { Happiness = 30, Health = -10 },
				feedText = "ğŸ”¥ CONTENT BLITZ! 5 videos in a week! Converted casual viewers into SUBSCRIBERS!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					local boost = math.random(50000, 200000)
					local newSubs = (state.FameState.subscribers or 0) + boost
					state.FameState.subscribers = newSubs
					state.FameState.totalViews = (state.FameState.totalViews or 0) + 5000000
					state.FameState.viralVideos = (state.FameState.viralVideos or 0) + 1
					-- CRITICAL FIX: Actually increment totalVideos when posting videos!
					state.FameState.totalVideos = (state.FameState.totalVideos or 0) + 5
					state.Fame = (state.Fame or 0) + 20
					state.Money = (state.Money or 0) + math.random(5000, 20000)
					
					-- CRITICAL FIX #USER-36: Update job title based on subscriber milestones!
					state.CurrentJob = state.CurrentJob or {}
					if newSubs >= 1000000 then
						state.CurrentJob.name = "Famous YouTuber (1M+)"
						state.CurrentJob.salary = math.max(state.CurrentJob.salary or 0, 500000)
						state:AddFeed(string.format("ğŸ”¥ VIRAL SUCCESS! Gained %d subs! You're a MILLION subscriber creator! ğŸ¥‡", boost))
					elseif newSubs >= 100000 then
						state.CurrentJob.name = "Popular YouTuber (100K+)"
						state.CurrentJob.salary = math.max(state.CurrentJob.salary or 0, 75000)
						state:AddFeed(string.format("ğŸ”¥ VIRAL SUCCESS! Gained %d subs! Ready for Silver Play Button! ğŸ¥ˆ", boost))
					elseif newSubs >= 10000 then
						state.CurrentJob.name = "Growing YouTuber"
						state.CurrentJob.salary = math.max(state.CurrentJob.salary or 0, 15000)
						state:AddFeed(string.format("ğŸ”¥ Gained %d subscribers from viral video! INSANE growth!", boost))
					else
						state:AddFeed(string.format("ğŸ”¥ Gained %d subscribers from viral video! INSANE growth!", boost))
					end
				end,
			},
			{
				text = "Engage with all the new comments",
				effects = { Happiness = 25 },
				feedText = "ğŸ”¥ Replying to EVERYONE! Community loves the engagement! Loyal fanbase forming!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					local boost = math.random(30000, 100000)
					local newSubs = (state.FameState.subscribers or 0) + boost
					state.FameState.subscribers = newSubs
					state.Fame = (state.Fame or 0) + 15
					
					-- CRITICAL FIX #USER-36: Update job title based on subscriber milestones
					state.CurrentJob = state.CurrentJob or {}
					if newSubs >= 100000 and (state.CurrentJob.name or ""):lower():find("hobbyist") then
						state.CurrentJob.name = "Growing YouTuber"
						state.CurrentJob.salary = math.max(state.CurrentJob.salary or 0, 15000)
					end
				end,
			},
			-- â­ CELEBRITY PREMIUM OPTION
			{
				text = "â­ [Celebrity] Leverage into brand deals",
				effects = { Happiness = 35, Money = 50000 },
				requiresGamepass = "CELEBRITY",
				gamepassEmoji = "â­",
				feedText = "â­ Celebrity gamepass! Brands are CALLING! $50K sponsorship deal signed! Full-time creator now!",
				setFlags = { brand_deal_creator = true },
				onResolve = function(state)
					state.FameState = state.FameState or {}
					state.FameState.subscribers = (state.FameState.subscribers or 0) + math.random(100000, 300000)
					state.Fame = (state.Fame or 0) + 30
					state.FameState.brandDeals = (state.FameState.brandDeals or 0) + 1
					state.CurrentJob = state.CurrentJob or {}
					state.CurrentJob.name = "Famous Content Creator"
					state.CurrentJob.salary = 150000
				end,
			},
		},
	},
	{
		id = "creator_100k_plaque",
		title = "ğŸ¥ˆ 100K SUBSCRIBERS - SILVER PLAY BUTTON!",
		emoji = "ğŸ¥ˆ",
		text = "YouTube sent you the SILVER PLAY BUTTON! 100,000 subscribers! You're officially a REAL creator!",
		question = "How do you feel?",
		minAge = 13, maxAge = 60,
		baseChance = 0.55,
		cooldown = 4,
		oneTime = true,
		category = "career_creative",
		-- REMOVED isCelebrityOnly - Silver play button is a milestone for ANY creator!
		-- CRITICAL FIX: Must be an actual content creator
		eligibility = function(state)
			if not isContentCreator(state) then
				return false, "This event is only for content creators"
			end
			local subs = state.FameState and state.FameState.subscribers or 0
			return subs >= 100000, "Need 100K subscribers"
		end,
		
		choices = {
			{
				text = "Unboxing video with tears of joy",
				effects = { Happiness = 35 },
				setFlags = { silver_play_button = true },
				feedText = "ğŸ¥ˆ SILVER PLAY BUTTON! You cried on camera. Fans loved the authenticity. MILESTONE ACHIEVED!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					state.FameState.subscribers = (state.FameState.subscribers or 0) + math.random(10000, 30000)
					state.Fame = (state.Fame or 0) + 25
					state.CurrentJob = state.CurrentJob or {}
					state.CurrentJob.name = "YouTuber (100K+)"
					state.CurrentJob.salary = 75000
				end,
			},
			{
				text = "Quietly hang it on the wall",
				effects = { Happiness = 25 },
				setFlags = { silver_play_button = true, humble_creator = true },
				feedText = "ğŸ¥ˆ Hung it on your wall. Quiet pride. Back to work. The grind never stops.",
			},
		},
	},
	{
		id = "creator_million_subs",
		title = "ğŸ¥‡ 1 MILLION SUBSCRIBERS - GOLD PLAY BUTTON!",
		emoji = "ğŸ¥‡",
		text = "ONE MILLION SUBSCRIBERS! You're in the TOP 0.1% of creators! The GOLD PLAY BUTTON arrives!",
		question = "You made it! What now?",
		minAge = 16, maxAge = 60,
		baseChance = 0.45,
		cooldown = 6,
		oneTime = true,
		category = "career_creative",
		-- REMOVED isCelebrityOnly - Gold play button is a milestone for ANY creator!
		-- CRITICAL FIX: Must be an actual content creator
		eligibility = function(state)
			if not isContentCreator(state) then
				return false, "This event is only for content creators"
			end
			local subs = state.FameState and state.FameState.subscribers or 0
			return subs >= 1000000, "Need 1 million subscribers"
		end,
		
		choices = {
			{
				text = "Massive celebration event",
				effects = { Happiness = 50, Money = -10000 },
				setFlags = { gold_play_button = true, millionaire_creator = true },
				feedText = "ğŸ¥‡ 1 MILLION! Party was LEGENDARY! You're an ICON! Career established FOREVER!",
				onResolve = function(state)
					state.Fame = math.min(100, (state.Fame or 0) + 50)
					state.Money = (state.Money or 0) + 500000 -- Brand deals flowing
					state.CurrentJob = state.CurrentJob or {}
					state.CurrentJob.name = "Famous YouTuber (1M+)"
					state.CurrentJob.salary = 500000
				end,
			},
			{
				text = "Start a second channel",
				effects = { Happiness = 40 },
				setFlags = { gold_play_button = true, multi_channel = true },
				feedText = "ğŸ¥‡ GOLD BUTTON secured! Started second channel. Building an empire!",
				onResolve = function(state)
					state.Fame = math.min(100, (state.Fame or 0) + 45)
					state.Money = (state.Money or 0) + 400000
				end,
			},
		},
	},
	
	-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
	-- MORE UNDERGROUND RAPPER EVENTS - The struggle is real
	-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
	{
		id = "rapper_cypher_invite",
		title = "ğŸ¤ Cypher Session Invite",
		emoji = "ğŸ¤",
		text = "Some local rappers are having a cypher tonight at the park. Everyone takes turns spitting bars. Good way to network and practice!",
		question = "Do you pull up?",
		minAge = 14, maxAge = 45,
		baseChance = 0.6,
		cooldown = 4, -- CRITICAL FIX: Increased from 2 to reduce spam
		category = "career_rapper",  -- FIXED: Use career_rapper not career_music
		-- CRITICAL FIX #509: Use isRapper helper instead of pursuing_rap flag
		eligibility = function(state) return isRapper(state) end,
		
		choices = {
			{
				text = "Show up and impress everyone",
				effects = { Happiness = 12 },
				setFlags = { cypher_regular = true },
				feedText = "ğŸ¤ You bodied the cypher! Everyone asking 'who is that??' Connections made!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					state.FameState.monthlyListeners = (state.FameState.monthlyListeners or 0) + math.random(50, 200)
					state.FameState.connections = (state.FameState.connections or 0) + 2
				end,
			},
			{
				text = "Just watch and learn",
				effects = { Happiness = 5, Smarts = 3 },
				feedText = "You observed the OGs. Learned some flows and techniques. Knowledge gained!",
			},
			{
				text = "Skip it - working on tracks",
				effects = { Happiness = 3 },
				feedText = "Stayed home recording. Missed networking but got new music done.",
			},
		},
	},
	{
		id = "rapper_producer_connect",
		title = "ğŸ¹ Producer Wants to Work With You!",
		emoji = "ğŸ¹",
		text = "A local producer DM'd you on Instagram. They've been making beats for 5 years, worked with some underground artists in your city, and just dropped a crazy beat tape. They heard your tracks and think your flow would be PERFECT on their production. They're offering FREE beats in exchange for a 50/50 royalty split on any tracks you release together. This could be the start of a legendary partnership... or just another DM that goes nowhere.",
		question = "A producer collab could change everything. What do you do?",
		minAge = 14, maxAge = 50,
		baseChance = 0.4,
		cooldown = 3,
		category = "career_rapper",
		requiresFlags = { first_track_recorded = true },
		
		choices = {
			{
				text = "ğŸ”¥ Let's cook! Lock in and make hits together",
				effects = { Happiness = 20, Smarts = 3, Health = -2 },  -- ENHANCED: More stats affected
				setFlags = { has_producer = true, producer_collab = true },
				feedText = "ğŸ¹ FIRE! You spent 3 weeks in the studio together. The producer's 808s hit DIFFERENT. Your flow rides the beats perfectly. You made 8 tracks and they're ALL heat. This is your sound now. The chemistry is REAL.",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					state.FameState.monthlyListeners = (state.FameState.monthlyListeners or 0) + math.random(500, 1500)
					state.FameState.producerConnect = true
					state.FameState.totalTracks = (state.FameState.totalTracks or 0) + 8
					state.Money = (state.Money or 0) + math.random(200, 800)  -- Some streaming revenue
					state.Fame = (state.Fame or 0) + 3
				end,
			},
			{
				text = "ğŸ’° Negotiate better - I want 70/30 my favor",
				effects = { Smarts = 5 },  -- Negotiating is smart
				feedText = "You're learning to advocate for yourself in this industry...",
				onResolve = function(state)
					if math.random() < 0.35 then
						state:ModifyStat("Happiness", 25)
						state.Flags = state.Flags or {}
						state.Flags.has_producer = true
						state.Flags.negotiator = true
						state.FameState = state.FameState or {}
						state.FameState.monthlyListeners = (state.FameState.monthlyListeners or 0) + math.random(600, 1200)
						state.FameState.totalTracks = (state.FameState.totalTracks or 0) + 5
						state.Money = (state.Money or 0) + math.random(500, 1500)
						state:AddFeed("ğŸ¹ They agreed to 70/30! You made 5 tracks together. Smart business move AND fire music. Industry respect +100.")
					else
						state:ModifyStat("Happiness", -8)
						state:AddFeed("ğŸ“‰ They said 'You're not popping enough to demand that' and went to work with another artist. L taken. Maybe next time focus on the music first, money second.")
					end
				end,
			},
			{
				text = "ğŸš« Nah, I make my own beats. Don't need you.",
				effects = { Happiness = -3, Smarts = 2 },
				setFlags = { self_produced = true },
				feedText = "You stay independent. Making your own beats is harder but you keep 100% of everything. Respect for the grind, but you might be missing opportunities.",
			},
		},
	},
	{
		id = "rapper_studio_session",
		title = "ğŸ™ï¸ Studio Session Time",
		emoji = "ğŸ™ï¸",
		text = "You've got studio time booked. Time to lay down some bars. How do you approach this session?",
		question = "What's your game plan?",
		minAge = 14, maxAge = 50,
		baseChance = 0.5,
		cooldown = 4, -- CRITICAL FIX: Increased from 2 to reduce spam
		category = "career_rapper",  -- FIXED: Use career_rapper not career_music
		requiresFlags = { first_track_recorded = true },
		
		choices = {
			{
				text = "Freestyle - capture raw energy",
				effects = { Happiness = 10 },
				feedText = "ğŸ™ï¸ Pure freestyle! Raw, unfiltered. Some takes were trash, but one was FIRE!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					state.FameState.tracksReleased = (state.FameState.tracksReleased or 0) + 1
					if math.random() < 0.3 then
						state.FameState.monthlyListeners = (state.FameState.monthlyListeners or 0) + math.random(500, 1500)
						state:AddFeed("ğŸ”¥ That freestyle track is catching! 'Best verse this year' comments!")
					end
				end,
			},
			{
				text = "Written bars - precise delivery",
				effects = { Happiness = 8, Smarts = 2 },
				feedText = "ğŸ™ï¸ Every word intentional. Clean takes. Professional quality improving!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					state.FameState.tracksReleased = (state.FameState.tracksReleased or 0) + 1
					state.FameState.monthlyListeners = (state.FameState.monthlyListeners or 0) + math.random(100, 400)
				end,
			},
			{
				text = "Experiment with new style",
				effects = { Happiness = 12 },
				feedText = "ğŸ™ï¸ Tried something different! Risky but could define your sound!",
				onResolve = function(state)
					local roll = math.random()
					state.FameState = state.FameState or {}
					if roll < 0.4 then
						state.FameState.monthlyListeners = (state.FameState.monthlyListeners or 0) + math.random(800, 2000)
						state:AddFeed("ğŸ”¥ The new style is HITTING! You're onto something!")
						state.Flags = state.Flags or {}
						state.Flags.unique_style = true
					else
						state:ModifyStat("Happiness", -5)
						state:AddFeed("Mixed reactions. Some love it, some hate it. Polarizing.")
					end
				end,
			},
		},
	},
	{
		id = "rapper_music_video",
		title = "ğŸ“¹ Shooting a Music Video",
		emoji = "ğŸ“¹",
		text = "Time to make a music video! Visuals are crucial for going viral. How much do you spend?",
		question = "What's your budget approach?",
		minAge = 16, maxAge = 50,
		baseChance = 0.555,
		cooldown = 4, -- CRITICAL FIX: Increased from 2 to reduce spam
		category = "career_rapper",  -- FIXED: Use career_rapper not career_music
		requiresFlags = { first_track_recorded = true },
		
		choices = {
			{
				text = "DIY with phone - $0",
				effects = { Happiness = 10 },
				feedText = "ğŸ“¹ Shot on iPhone in your neighborhood. Gritty, authentic. Underground approved!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					state.FameState.monthlyListeners = (state.FameState.monthlyListeners or 0) + math.random(200, 800)
					state.FameState.musicVideos = (state.FameState.musicVideos or 0) + 1
				end,
			},
			{
				text = "Budget video - $500",
				effects = { Happiness = 12, Money = -500 },
				feedText = "ğŸ“¹ Hired a local videographer. Clean shots! Professional but still street!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					state.FameState.monthlyListeners = (state.FameState.monthlyListeners or 0) + math.random(500, 1500)
					state.FameState.musicVideos = (state.FameState.musicVideos or 0) + 1
				end,
			},
			{
				text = "Professional video - $5000",
				effects = { Happiness = 15, Money = -5000 },
				feedText = "ğŸ“¹ Real set, director, effects! This looks like a MAJOR artist video!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					state.FameState.monthlyListeners = (state.FameState.monthlyListeners or 0) + math.random(2000, 6000)
					state.FameState.musicVideos = (state.FameState.musicVideos or 0) + 1
					state.Fame = (state.Fame or 0) + 5
				end,
			},
		},
	},
	{
		id = "rapper_hater_comments",
		title = "ğŸ˜¤ Haters in the Comments",
		emoji = "ğŸ˜¤",
		text = "Your new track dropped and someone's going OFF in the comments. 'Mid.' 'Trash.' 'Go back to your day job.' Pure hate.",
		question = "How do you respond?",
		minAge = 14, maxAge = 50,
		baseChance = 0.45,
		cooldown = 4, -- CRITICAL FIX: Increased from 2 to reduce spam
		category = "career_rapper",  -- FIXED: Use career_rapper not career_music
		requiresFlags = { first_track_recorded = true },
		
		choices = {
			{
				text = "Clap back HARD",
				effects = {},
				feedText = "Firing back...",
				onResolve = function(state)
					local roll = math.random()
					if roll < 0.4 then
						state:ModifyStat("Happiness", 15)
						state.FameState = state.FameState or {}
						state.FameState.monthlyListeners = (state.FameState.monthlyListeners or 0) + math.random(300, 1000)
						state:AddFeed("ğŸ˜¤ Your clap back went VIRAL! 'Rapper destroys hater!' W taken!")
					else
						state:ModifyStat("Happiness", -10)
						state:AddFeed("ğŸ˜¤ You looked pressed. They're laughing at you now. L taken.")
					end
				end,
			},
			{
				text = "Ignore completely - focus on music",
				effects = { Happiness = 5, Smarts = 3 },
				setFlags = { thick_skin = true },
				feedText = "Don't feed the trolls. Your music speaks for itself. Maturity shown.",
			},
			{
				text = "Turn it into motivation",
				effects = { Happiness = 8 },
				setFlags = { chip_on_shoulder = true },
				feedText = "Screenshot saved. Fuel for the fire. You'll show them.",
			},
		},
	},
	{
		id = "rapper_sample_clearance",
		title = "âš ï¸ Sample Clearance Issue",
		emoji = "âš ï¸",
		text = "Your track with the fire sample is getting copyright claimed. The original artist's label wants $10,000 for clearance or they'll take down the song!",
		question = "What do you do?",
		minAge = 16, maxAge = 50,
		baseChance = 0.455,
		cooldown = 4, -- CRITICAL FIX: Increased from 2 to reduce spam
		category = "career_rapper",  -- FIXED: Use career_rapper not career_music
		requiresFlags = { has_mixtape = true },
		
		choices = {
			{
				text = "Pay for clearance ($10,000)",
				effects = { Happiness = -5, Money = -10000 },
				feedText = "âš ï¸ Expensive lesson. Sample cleared. Song stays up. Budget hurting though.",
				onResolve = function(state)
					state.Flags = state.Flags or {}
					state.Flags.sample_cleared = true
				end,
			},
			{
				text = "Re-record with original beat",
				effects = { Happiness = 8, Money = -200 },
				feedText = "âš ï¸ Had a producer remake something similar. Not the same but it's YOURS now!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					state.FameState.tracksReleased = (state.FameState.tracksReleased or 0) + 1
				end,
			},
			{
				text = "Fight it - fair use!",
				effects = {},
				feedText = "Lawyering up...",
				onResolve = function(state)
					if math.random() < 0.2 then
						state:ModifyStat("Happiness", 20)
						state:AddFeed("âš ï¸ You won! Fair use argument worked! The track stays up FREE!")
					else
						state:ModifyStat("Happiness", -15)
						-- CRITICAL FIX: Prevent negative money
						state.Money = math.max(0, (state.Money or 0) - 3000)
						state:AddFeed("âš ï¸ Lost the dispute. Song taken down + $3000 in legal fees. Rough L.")
					end
				end,
			},
		},
	},
	{
		id = "rapper_opening_act",
		title = "ğŸª Opening Act Opportunity",
		emoji = "ğŸª",
		text = "A mid-level rapper is performing in your city and needs an opening act. You could perform for 15 minutes to THEIR crowd!",
		question = "Do you take the slot?",
		minAge = 16, maxAge = 50,
		baseChance = 0.55,
		cooldown = 4, -- CRITICAL FIX: Increased from 2 to reduce spam
		category = "career_rapper",  -- FIXED: Use career_rapper not career_music
		requiresFlags = { stage_experience = true },
		eligibility = function(state)
			local listeners = state.FameState and state.FameState.monthlyListeners or 0
			return listeners >= 1000, "Need at least 1000 monthly listeners"
		end,
		
		choices = {
			{
				text = "Open the show and KILL IT",
				effects = { Happiness = 20 },
				setFlags = { opened_for_artist = true },
				feedText = "ğŸª You set the stage ON FIRE! The headliner's crowd became YOUR fans!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					state.FameState.monthlyListeners = (state.FameState.monthlyListeners or 0) + math.random(1000, 3000)
					state.FameState.showsPerformed = (state.FameState.showsPerformed or 0) + 1
					state.Fame = (state.Fame or 0) + 3
				end,
			},
			{
				text = "Network backstage after",
				effects = { Happiness = 15, Smarts = 3 },
				feedText = "ğŸª Met the headliner! Exchanged numbers. Could be future collabs!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					state.FameState.connections = (state.FameState.connections or 0) + 2
					state.FameState.showsPerformed = (state.FameState.showsPerformed or 0) + 1
				end,
			},
		},
	},
	
	-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
	-- RAPPER PROGRESSION EVENTS - Leveling up in the game
	-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
	{
		id = "rapper_10k_milestone",
		title = "ğŸ‰ 10,000 Monthly Listeners!",
		emoji = "ğŸ‰",
		text = "You hit 10K monthly listeners! You're officially not underground anymore. Local blogs are covering you!",
		question = "How do you celebrate?",
		minAge = 16, maxAge = 55,
		baseChance = 0.5,
		cooldown = 4, -- CRITICAL FIX: Increased from 2 to reduce spam
		oneTime = true,
		category = "career_rapper",  -- FIXED: Use career_rapper not career_music
		-- REMOVED isCelebrityOnly - 10K is a milestone for ANY rapper!
		-- CRITICAL FIX #509: Use isRapper helper
		eligibility = function(state)
			if not isRapper(state) then return false end
			local listeners = state.FameState and state.FameState.monthlyListeners or 0
			return listeners >= 10000, "Need 10K listeners"
		end,
		
		choices = {
			{
				text = "Throw a listening party",
				effects = { Happiness = 25, Money = -500 },
				setFlags = { local_rapper = true },
				feedText = "ğŸ‰ 10K CELEBRATION! Your real fans showed up! Community built!",
				onResolve = function(state)
					state.Fame = (state.Fame or 0) + 10
					state.CurrentJob = state.CurrentJob or {}
					state.CurrentJob.name = "Local Rapper"
					state.CurrentJob.salary = 15000
				end,
			},
			{
				text = "Back to the grind - 100K next",
				effects = { Happiness = 15 },
				setFlags = { local_rapper = true, hungry_rapper = true },
				feedText = "ğŸ‰ 10K is just the beginning. Eyes on 100K. No celebrations til we're there!",
				onResolve = function(state)
					state.Fame = (state.Fame or 0) + 8
				end,
			},
		},
	},
	{
		id = "rapper_100k_milestone",
		title = "ğŸ’¯ 100,000 Monthly Listeners!",
		emoji = "ğŸ’¯",
		text = "100K! You're OFFICIALLY buzzing! Playlists are adding you. Blogs writing about you. Labels noticing!",
		question = "You're leveling up!",
		minAge = 17, maxAge = 55,
		baseChance = 0.4,
		cooldown = 3,
		oneTime = true,
		category = "career_rapper",  -- FIXED: Use career_rapper not career_music
		-- REMOVED isCelebrityOnly - 100K is a milestone for ANY rapper!
		-- CRITICAL FIX #509: Use isRapper helper
		eligibility = function(state)
			if not isRapper(state) then return false end
			local listeners = state.FameState and state.FameState.monthlyListeners or 0
			return listeners >= 100000, "Need 100K listeners"
		end,
		
		choices = {
			{
				text = "Sign management deal",
				effects = { Happiness = 25, Money = 25000 },
				setFlags = { has_management = true, hot_rapper = true },
				feedText = "ğŸ’¯ MANAGEMENT SIGNED! They're booking shows, handling business. You just RAP!",
				onResolve = function(state)
					state.Fame = (state.Fame or 0) + 20
					state.CurrentJob = state.CurrentJob or {}
					state.CurrentJob.name = "Hot Rapper"
					state.CurrentJob.salary = 75000
				end,
			},
			{
				text = "Stay independent - own everything",
				effects = { Happiness = 20 },
				setFlags = { indie_rapper = true, hot_rapper = true },
				feedText = "ğŸ’¯ 100K as an INDIE! You own your masters. The hardest path but most rewarding!",
				onResolve = function(state)
					state.Fame = (state.Fame or 0) + 18
					state.CurrentJob = state.CurrentJob or {}
					state.CurrentJob.name = "Independent Rapper"
					state.CurrentJob.salary = 50000
				end,
			},
		},
	},
	{
		id = "rapper_500k_milestone",
		title = "ğŸ”¥ 500K Monthly Listeners!",
		emoji = "ğŸ”¥",
		text = "HALF A MILLION MONTHLY LISTENERS! You're mainstream now! Radio play, playlist covers, brand deals incoming!",
		question = "You've MADE IT!",
		minAge = 18, maxAge = 60,
		baseChance = 0.55,
		cooldown = 4,
		oneTime = true,
		category = "career_rapper",  -- FIXED: Use career_rapper not career_music
		-- REMOVED isCelebrityOnly - 500K is a milestone for ANY rapper!
		-- CRITICAL FIX #509: Use isRapper helper
		eligibility = function(state)
			if not isRapper(state) then return false end
			local listeners = state.FameState and state.FameState.monthlyListeners or 0
			return listeners >= 500000, "Need 500K listeners"
		end,
		
		choices = {
			{
				text = "Major label deal time",
				effects = { Happiness = 35, Money = 200000 },
				setFlags = { mainstream_rapper = true, major_label = true },
				feedText = "ğŸ”¥ MAJOR LABEL SIGNED! $200K ADVANCE! You're on the RADIO! MAINSTREAM!",
				onResolve = function(state)
					state.Fame = (state.Fame or 0) + 35
					state.CurrentJob = state.CurrentJob or {}
					state.CurrentJob.name = "Mainstream Rapper"
					state.CurrentJob.salary = 250000
				end,
			},
			{
				text = "Build your own label",
				effects = { Happiness = 30, Money = -50000 },
				setFlags = { mainstream_rapper = true, label_owner = true },
				feedText = "ğŸ”¥ Started your OWN LABEL! Signing other artists. Building an EMPIRE!",
				onResolve = function(state)
					state.Fame = (state.Fame or 0) + 30
					state.CurrentJob = state.CurrentJob or {}
					state.CurrentJob.name = "Rapper/Label Owner"
					state.CurrentJob.salary = 300000
				end,
			},
		},
	},
	{
		id = "rapper_1m_milestone",
		title = "â­ 1 MILLION MONTHLY LISTENERS!",
		emoji = "â­",
		text = "ONE MILLION! You're a STAR! Top of charts, sold out shows, everyone knows your name!",
		question = "LEGENDARY STATUS!",
		minAge = 18, maxAge = 65,
		baseChance = 0.45,
		cooldown = 5,
		oneTime = true,
		category = "career_rapper",  -- FIXED: Use career_rapper not career_music
		-- REMOVED isCelebrityOnly - 1M is a milestone for ANY rapper!
		-- CRITICAL FIX #509: Use isRapper helper
		eligibility = function(state)
			if not isRapper(state) then return false end
			local listeners = state.FameState and state.FameState.monthlyListeners or 0
			return listeners >= 1000000, "Need 1M listeners"
		end,
		
		choices = {
			{
				text = "World tour announcement",
				effects = { Happiness = 50, Money = 500000 },
				setFlags = { superstar_rapper = true, world_tour = true },
				feedText = "â­ WORLD TOUR ANNOUNCED! 50 cities! Sold out in MINUTES! SUPERSTAR!",
				onResolve = function(state)
					state.Fame = math.min(100, (state.Fame or 0) + 50)
					state.CurrentJob = state.CurrentJob or {}
					state.CurrentJob.name = "Superstar Rapper"
					state.CurrentJob.salary = 1000000
				end,
			},
			{
				text = "Drop surprise album",
				effects = { Happiness = 45, Money = 300000 },
				setFlags = { superstar_rapper = true },
				feedText = "â­ SURPRISE ALBUM DROP! Internet EXPLODING! #1 IN THE WORLD! ICON!",
				onResolve = function(state)
					state.Fame = math.min(100, (state.Fame or 0) + 45)
					state.FameState = state.FameState or {}
					state.FameState.albumsReleased = (state.FameState.albumsReleased or 0) + 1
				end,
			},
		},
	},
	
	-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
	-- CONTENT CREATOR EXPANSION - More events for YouTubers/Streamers
	-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
	{
		id = "creator_burnout",
		title = "ğŸ˜“ Creator Burnout",
		emoji = "ğŸ˜“",
		text = "You've been grinding content for months. The algorithm demands MORE. But you're exhausted. Views are down because you're running on empty.",
		question = "How do you handle burnout?",
		minAge = 15, maxAge = 50,
		baseChance = 0.4,
		cooldown = 4, -- CRITICAL FIX: Increased from 2 to reduce spam
		category = "career_creative",
		-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
		-- CRITICAL FIX: Must check for actual content creator JOB, not just flags!
		-- Bug: IT Support worker was getting "YouTuber Burnout" because they had
		-- a content_creator flag from some unrelated event. This is NOT a YouTuber event!
		-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
		eligibility = function(state)
			-- MUST be an actual content creator by job or have active creator career
			if not isContentCreator(state) then
				return false, "This event is only for content creators/streamers"
			end
			-- Additionally require one of the burnout-relevant flags
			return state.Flags and (state.Flags.daily_uploader or state.Flags.content_creator or state.Flags.streamer)
		end,
		
		choices = {
			{
				text = "Take a mental health break",
				effects = { Happiness = 15, Health = 10 },
				setFlags = { took_break = true },
				feedText = "ğŸ˜“ Announced a break. Some fans understood. Numbers dipped but your HEALTH matters!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					state.FameState.subscribers = math.max(0, (state.FameState.subscribers or 0) - math.random(500, 2000))
				end,
			},
			{
				text = "Push through - the grind doesn't stop",
				effects = { Happiness = -15, Health = -15 },
				feedText = "ğŸ˜“ You pushed through. Content suffered. You're a shell of yourself. Worth it?",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					state.FameState.subscribers = (state.FameState.subscribers or 0) + math.random(1000, 3000)
				end,
			},
			{
				text = "Hire an editor/team",
				effects = { Happiness = 10, Money = -2000 },
				setFlags = { has_team = true },
				feedText = "ğŸ˜“ Hired help! Delegation is key. Quality up, stress down. Smart move!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					state.FameState.subscribers = (state.FameState.subscribers or 0) + math.random(2000, 5000)
				end,
			},
		},
	},
	{
		id = "creator_collab_request",
		title = "ğŸ¤ Big Creator Wants to Collab",
		emoji = "ğŸ¤",
		text = "A creator with 500K subscribers reached out! They want to do a collab video. This could EXPLODE your growth!",
		question = "How do you approach this?",
		minAge = 15, maxAge = 50,
		baseChance = 0.455,
		cooldown = 4, -- CRITICAL FIX: Increased from 2 to reduce spam
		category = "career_creative",
		-- REMOVED isCelebrityOnly - Collabs happen to growing creators!
		-- CRITICAL FIX: Must be an actual content creator
		eligibility = function(state)
			if not isContentCreator(state) then
				return false, "This event is only for content creators"
			end
			local subs = state.FameState and state.FameState.subscribers or 0
			return subs >= 10000, "Need 10K+ subs for big collabs"
		end,
		
		choices = {
			{
				text = "Make an amazing collab video",
				effects = { Happiness = 25 },
				setFlags = { big_collab = true },
				feedText = "ğŸ¤ COLLAB VIDEO DROPPED! Their audience is now YOUR audience! MASSIVE GROWTH!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					state.FameState.subscribers = (state.FameState.subscribers or 0) + math.random(30000, 100000)
					state.Fame = (state.Fame or 0) + 15
					-- CRITICAL FIX: Track video count
					state.FameState.totalVideos = (state.FameState.totalVideos or 0) + 1
					state.FameState.totalViews = (state.FameState.totalViews or 0) + math.random(500000, 2000000)
				end,
			},
			{
				text = "Do a series - multiple videos",
				effects = { Happiness = 30 },
				feedText = "ğŸ¤ COLLAB SERIES! 5 videos over 5 weeks! Sustained growth! Community merging!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					state.FameState.subscribers = (state.FameState.subscribers or 0) + math.random(50000, 150000)
					state.Fame = (state.Fame or 0) + 20
					-- CRITICAL FIX: Track video count - 5 video series
					state.FameState.totalVideos = (state.FameState.totalVideos or 0) + 5
					state.FameState.totalViews = (state.FameState.totalViews or 0) + math.random(2000000, 8000000)
				end,
			},
		},
	},
	{
		id = "creator_sponsor_offer",
		title = "ğŸ’¼ Sponsorship Offer",
		emoji = "ğŸ’¼",
		text = "A brand wants to sponsor your videos! They're offering $1,000 per video to promote their product. But your audience might see it as selling out...",
		question = "Do you take the sponsorship?",
		minAge = 16, maxAge = 50,
		baseChance = 0.555,
		cooldown = 4, -- CRITICAL FIX: Increased from 2 to reduce spam
		category = "career_creative",
		-- CRITICAL FIX: Must be an actual content creator
		eligibility = function(state)
			if not isContentCreator(state) then
				return false, "This event is only for content creators"
			end
			local subs = state.FameState and state.FameState.subscribers or 0
			return subs >= 5000, "Need 5K+ subs for sponsors"
		end,
		
		choices = {
			{
				text = "Take it - money is money",
				effects = { Happiness = 10, Money = 1000 },
				setFlags = { has_sponsors = true },
				feedText = "ğŸ’¼ Sponsored video posted. Most fans understood. Some called you a sellout. $1000 secured!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					state.FameState.brandDeals = (state.FameState.brandDeals or 0) + 1
					-- CRITICAL FIX: Track video count for sponsored video
					state.FameState.totalVideos = (state.FameState.totalVideos or 0) + 1
					state.FameState.totalViews = (state.FameState.totalViews or 0) + math.random(10000, 50000)
				end,
			},
			{
				text = "Negotiate for more ($2,500)",
				effects = {},
				feedText = "Negotiating...",
				onResolve = function(state)
					if math.random() < 0.5 then
						state.Money = (state.Money or 0) + 2500
						state:ModifyStat("Happiness", 15)
						state:AddFeed("ğŸ’¼ They agreed! $2,500 per video! Know your worth!")
						state.FameState = state.FameState or {}
						state.FameState.brandDeals = (state.FameState.brandDeals or 0) + 1
					else
						state:ModifyStat("Happiness", -3)
						state:AddFeed("They passed. Went with a different creator. Missed income.")
					end
				end,
			},
			{
				text = "Decline - staying authentic",
				effects = { Happiness = 5 },
				setFlags = { no_sponsors = true },
				feedText = "ğŸ’¼ Turned it down. Fans respect the authenticity. But rent is still due...",
			},
		},
	},
	{
		id = "creator_drama",
		title = "ğŸ­ YouTube Drama",
		emoji = "ğŸ­",
		text = "Another creator made a video about you! They're claiming you 'stole' their content idea. Your comments are a warzone!",
		question = "How do you respond?",
		minAge = 15, maxAge = 50,
		baseChance = 0.455,
		cooldown = 4, -- CRITICAL FIX: Increased from 2 to reduce spam
		category = "career_creative",
		-- CRITICAL FIX: Must be an actual content creator
		eligibility = function(state)
			if not isContentCreator(state) then
				return false, "This event is only for content creators"
			end
			local subs = state.FameState and state.FameState.subscribers or 0
			return subs >= 20000, "Need relevance for drama"
		end,
		
		choices = {
			{
				text = "Make a response video",
				effects = {},
				feedText = "Recording response...",
				onResolve = function(state)
					local roll = math.random()
					state.FameState = state.FameState or {}
					-- CRITICAL FIX: Track video count for response video
					state.FameState.totalVideos = (state.FameState.totalVideos or 0) + 1
					state.FameState.totalViews = (state.FameState.totalViews or 0) + math.random(100000, 500000)
					if roll < 0.5 then
						state:ModifyStat("Happiness", 20)
						state.FameState.subscribers = (state.FameState.subscribers or 0) + math.random(20000, 60000)
						state:AddFeed("ğŸ­ Your response was PERFECT! You came off as reasonable. They look crazy!")
					else
						state:ModifyStat("Happiness", -10)
						state.FameState.subscribers = math.max(0, (state.FameState.subscribers or 0) - math.random(5000, 15000))
						state:AddFeed("ğŸ­ Response backfired. You looked defensive. L taken.")
					end
				end,
			},
			{
				text = "Ignore it completely",
				effects = { Happiness = -5 },
				feedText = "ğŸ­ No response. Some say you're 'above it.' Others think you're guilty. Drama died down eventually.",
			},
			{
				text = "Handle it privately - DM them",
				effects = { Happiness = 10, Smarts = 5 },
				feedText = "ğŸ­ DMed them. Worked it out. They deleted the video. Maturity wins!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					state.FameState.connections = (state.FameState.connections or 0) + 1
				end,
			},
		},
	},
	{
		id = "creator_demonetized",
		title = "ğŸ’” Demonetized!",
		emoji = "ğŸ’”",
		text = "YouTube demonetized your latest video for 'guideline violations.' You didn't break any rules! This is your income!",
		question = "What do you do?",
		minAge = 16, maxAge = 50,
		baseChance = 0.45,
		cooldown = 3,
		category = "career_creative",
		requiresFlags = { monetized = true },
		-- CRITICAL FIX: Must be an actual content creator
		eligibility = function(state)
			if not isContentCreator(state) then
				return false, "This event is only for content creators"
			end
			return true
		end,
		
		choices = {
			{
				text = "Appeal the decision",
				effects = {},
				feedText = "Filing appeal...",
				onResolve = function(state)
					if math.random() < 0.6 then
						state:ModifyStat("Happiness", 15)
						state.Money = (state.Money or 0) + 500
						state:AddFeed("ğŸ’” Appeal APPROVED! Monetization restored! The system worked for once!")
					else
						state:ModifyStat("Happiness", -15)
						state:AddFeed("ğŸ’” Appeal DENIED. No explanation. Welcome to being a creator.")
					end
				end,
			},
			{
				text = "Complain publicly on Twitter",
				effects = { Happiness = -5 },
				feedText = "ğŸ’” Your tweet went semi-viral. YouTube still didn't care. But solidarity from other creators!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					state.FameState.subscribers = (state.FameState.subscribers or 0) + math.random(500, 2000)
				end,
			},
			{
				text = "Diversify income - Patreon",
				effects = { Happiness = 10, Money = 200 },
				setFlags = { has_patreon = true },
				feedText = "ğŸ’” Started a Patreon! Direct fan support! Less dependent on platform whims!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					state.FameState.patreonSupport = true
				end,
			},
		},
	},
	{
		id = "creator_merch_launch",
		title = "ğŸ‘• Merch Launch Time",
		emoji = "ğŸ‘•",
		text = "Your audience is asking for merch! Time to launch your own clothing line. But it requires upfront investment...",
		question = "How big do you go?",
		minAge = 16, maxAge = 50,
		baseChance = 0.55,
		cooldown = 3,
		category = "career_creative",
		-- CRITICAL FIX: Must be an actual content creator
		eligibility = function(state)
			if not isContentCreator(state) then
				return false, "This event is only for content creators"
			end
			local subs = state.FameState and state.FameState.subscribers or 0
			return subs >= 25000, "Need 25K+ subs for merch"
		end,
		
		choices = {
			{
				text = "Small run - 100 items ($2,000)",
				effects = { Happiness = 15, Money = -2000 },
				setFlags = { has_merch = true },
				feedText = "ğŸ‘• Merch dropped! SOLD OUT IN 3 HOURS! $5,000 profit! Your fans LOVE you!",
				onResolve = function(state)
					state.Money = (state.Money or 0) + 5000
					state.FameState = state.FameState or {}
					state.FameState.merchSales = (state.FameState.merchSales or 0) + 1
				end,
			},
			{
				text = "Full collection - ($10,000)",
				effects = { Happiness = 20, Money = -10000 },
				setFlags = { has_merch = true, merch_brand = true },
				feedText = "ğŸ‘• Full collection launched! Hoodies, tees, hats! $25,000 in sales! BRAND BUILT!",
				onResolve = function(state)
					state.Money = (state.Money or 0) + 25000
					state.Fame = (state.Fame or 0) + 10
				end,
			},
		},
	},
	{
		id = "creator_10m_views",
		title = "ğŸ“º 10 MILLION VIEWS VIDEO!",
		emoji = "ğŸ“º",
		text = "One of your videos just hit 10 MILLION VIEWS! This is MASSIVE! You're trending worldwide!",
		question = "This changes everything!",
		minAge = 15, maxAge = 55,
		baseChance = 0.1,
		cooldown = 12,
		oneTime = false,
		maxOccurrences = 3,
		category = "career_creative",
		-- REMOVED isCelebrityOnly - 10M views can happen to ANY creator!
		-- CRITICAL FIX: Must be an actual content creator
		eligibility = function(state)
			if not isContentCreator(state) then
				return false, "This event is only for content creators"
			end
			local subs = state.FameState and state.FameState.subscribers or 0
			return subs >= 100000, "Need established channel"
		end,
		
		choices = {
			{
				text = "Ride the momentum - upload DAILY",
				effects = { Happiness = 30, Health = -10 },
				feedText = "ğŸ“º CONTENT BLITZ! Converting viewers to subscribers! EXPLOSIVE GROWTH!",
				onResolve = function(state)
					state.FameState = state.FameState or {}
					state.FameState.subscribers = (state.FameState.subscribers or 0) + math.random(200000, 500000)
					state.FameState.totalViews = (state.FameState.totalViews or 0) + 10000000
					state.Fame = (state.Fame or 0) + 30
					state.Money = (state.Money or 0) + math.random(20000, 50000)
				end,
			},
			{
				text = "Secure brand deals from attention",
				effects = { Happiness = 35, Money = 100000 },
				feedText = "ğŸ“º BRANDS ARE CALLING! Major sponsorship secured! $100K deal! You're ELITE now!",
				onResolve = function(state)
					state.Fame = (state.Fame or 0) + 25
					state.FameState = state.FameState or {}
					state.FameState.subscribers = (state.FameState.subscribers or 0) + math.random(150000, 400000)
				end,
			},
		},
	},
}

return RapperContentCreatorEvents
