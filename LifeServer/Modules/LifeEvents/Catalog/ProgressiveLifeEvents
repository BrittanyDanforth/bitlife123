--[[
	ProgressiveLifeEvents.lua
	
	CRITICAL FIX #716-750: MASSIVE EXPANSION OF PROGRESSIVE LIFE EVENTS (Ages 0-30)
	
	This module adds 100+ new events that create meaningful life progression
	from birth to age 30. Events are designed to:
	- Provide unique experiences that don't repeat
	- Create natural story progression
	- Support both royal and non-royal paths
	- Give players meaningful choices that affect their life
	
	All events have high cooldowns and are oneTime where appropriate
	to prevent repetition across different lives.
]]

local ProgressiveLifeEvents = {}

local RANDOM = Random.new()

ProgressiveLifeEvents.events = {
	-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
	-- BABY EVENTS (Ages 0-2) - More variety in early life
	-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
	{
		id = "baby_first_smile",
		title = "ğŸ‘¶ Your First Smile",
		emoji = "ğŸ˜Š",
		text = "You smiled for the first time! Your parents are overjoyed.",
		minAge = 0, maxAge = 1,
		oneTime = true,
		isMilestone = true,
		category = "childhood",
		tags = { "baby", "milestone", "family" },
		choices = {
			{
				text = "Smile at mommy",
				effects = { Happiness = 5 },
				setFlags = { first_smile_mom = true },
				feedText = "Your first smile melted your mother's heart.",
			},
			{
				text = "Smile at daddy",
				effects = { Happiness = 5 },
				setFlags = { first_smile_dad = true },
				feedText = "Your father couldn't stop grinning back at you.",
			},
			{
				text = "Smile at a pet",
				effects = { Happiness = 5 },
				setFlags = { first_smile_pet = true, animal_lover = true },
				feedText = "The family pet made you laugh! A bond is forming.",
			},
		},
	},
	{
		id = "baby_first_laugh",
		title = "ğŸ‘¶ First Giggles",
		emoji = "ğŸ˜‚",
		text = "You burst into laughter for the first time!",
		minAge = 0, maxAge = 1,
		oneTime = true,
		category = "childhood",
		tags = { "baby", "milestone", "joy" },
		choices = {
			{
				text = "Laugh at peek-a-boo",
				effects = { Happiness = 6 },
				feedText = "Peek-a-boo is the BEST game ever!",
			},
			{
				text = "Laugh at funny faces",
				effects = { Happiness = 6 },
				feedText = "Your parents made silly faces and you loved it!",
			},
			{
				text = "Laugh at nothing in particular",
				effects = { Happiness = 7 },
				setFlags = { naturally_happy = true },
				feedText = "You just laughed because life is wonderful!",
			},
		},
	},
	{
		id = "baby_teething_pain",
		title = "ğŸ¦· Teething Troubles",
		emoji = "ğŸ˜¢",
		text = "Your first teeth are coming in. It's not comfortable.",
		minAge = 0, maxAge = 2,
		oneTime = true,
		category = "childhood",
		tags = { "baby", "health", "development" },
		choices = {
			{
				text = "Cry a lot",
				effects = { Happiness = -5, Health = 2 },
				feedText = "Teething was rough, but at least you have teeth now!",
			},
			{
				text = "Chew on everything",
				effects = { Happiness = -2, Health = 2 },
				setFlags = { chewer = true },
				feedText = "You gnawed on anything you could find for relief.",
			},
			{
				text = "Handle it bravely",
				effects = { Happiness = 0, Health = 3 },
				setFlags = { pain_tolerant = true },
				feedText = "You toughed it out! What a brave baby.",
			},
		},
	},
	{
		id = "baby_first_food",
		title = "ğŸ¥„ First Solid Foods",
		emoji = "ğŸ¼",
		text = "Time to try real food for the first time!",
		minAge = 0, maxAge = 1,
		oneTime = true,
		category = "childhood",
		tags = { "baby", "food", "milestone" },
		choices = {
			{
				text = "Love it immediately",
				effects = { Health = 3, Happiness = 5 },
				setFlags = { adventurous_eater = true },
				feedText = "You gobbled it up! A foodie is born.",
			},
			{
				text = "Spit it everywhere",
				effects = { Happiness = 2 },
				setFlags = { messy_eater = true },
				feedText = "Food ended up everywhere except your mouth.",
			},
			{
				text = "Stare suspiciously",
				effects = { Smarts = 2 },
				setFlags = { cautious_eater = true },
				feedText = "You studied the food carefully before trying it.",
			},
		},
	},
	
	-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
	-- TODDLER EVENTS (Ages 2-4) - Building personality
	-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
	{
		id = "toddler_potty_training",
		title = "ğŸš½ Potty Training Adventure",
		emoji = "ğŸš½",
		text = "It's time to learn to use the potty!",
		minAge = 2, maxAge = 3,
		oneTime = true,
		isMilestone = true,
		category = "childhood",
		tags = { "toddler", "milestone", "development" },
		choices = {
			{
				text = "Learn quickly",
				effects = { Smarts = 3, Happiness = 5 },
				setFlags = { quick_learner = true, potty_trained = true },
				feedText = "You mastered the potty in no time! Parents relieved.",
			},
			{
				text = "Take your time",
				effects = { Happiness = 2 },
				setFlags = { potty_trained = true },
				feedText = "It took a while, but you got there eventually.",
			},
			{
				text = "Resist change",
				effects = { Happiness = -2, Smarts = 1 },
				setFlags = { stubborn = true, potty_trained = true },
				feedText = "You were stubborn about it, but finally gave in.",
			},
		},
	},
	{
		id = "toddler_curiosity_incident",
		title = "ğŸ” Curious Explorer",
		emoji = "ğŸ”",
		text = "You found something interesting while exploring the house!",
		minAge = 2, maxAge = 4,
		cooldown = 4,
		category = "childhood",
		tags = { "toddler", "exploration", "adventure" },
		choices = {
			{
				text = "Investigate the cabinets",
				effects = {},
				feedText = "Cabinet exploration commences...",
				onResolve = function(state)
					local roll = math.random()
					if roll < 0.50 then
						state:ModifyStat("Smarts", 3)
						state:AddFeed("ğŸ” You found pots and pans! Music time!")
					elseif roll < 0.80 then
						state:ModifyStat("Smarts", 2)
						state:AddFeed("ğŸ” You discovered Tupperware. Building blocks!")
					else
						state:ModifyStat("Health", -3)
						state.Flags = state.Flags or {}
						state.Flags.learned_lesson = true
						state:AddFeed("ğŸ” Found the cleaning supplies. Tasted bad!")
					end
				end,
			},
			{
				text = "Open the forbidden drawer",
				effects = {},
				feedText = "The drawer beckons...",
				onResolve = function(state)
					local roll = math.random()
					if roll < 0.40 then
						state:ModifyStat("Happiness", 5)
						state.Flags = state.Flags or {}
						state.Flags.found_treasure = true
						state:AddFeed("ğŸ” Old photos! You found baby pictures!")
					else
						state:ModifyStat("Happiness", -2)
						state:AddFeed("ğŸ” Just boring papers. Adults are weird.")
					end
				end,
			},
			{
				text = "Ask for help reaching something",
				effects = { Smarts = 2 },
				setFlags = { asks_for_help = true },
				feedText = "Smart! You got adult help to explore safely.",
			},
		},
	},
	{
		id = "toddler_sibling_dynamics",
		title = "ğŸ‘¶ Sibling Interactions",
		emoji = "ğŸ‘¶",
		text = "You're learning to navigate life with siblings.",
		minAge = 2, maxAge = 5,
		cooldown = 4,
		category = "childhood",
		tags = { "toddler", "family", "siblings" },
		eligibility = function(state)
			-- Only trigger if player has siblings
			if state.Relationships then
				for relId, rel in pairs(state.Relationships) do
					if type(rel) == "table" then
						local role = (rel.role or ""):lower()
						if role:find("brother") or role:find("sister") or role:find("sibling") then
							return true
						end
					end
				end
			end
			return false
		end,
		choices = {
			{
				text = "Share toys nicely",
				effects = { Happiness = 5 },
				setFlags = { shares_well = true },
				feedText = "You learned to share. Your parents are proud!",
			},
			{
				text = "Fight over everything",
				effects = { Happiness = -3 },
				setFlags = { sibling_rivalry = true },
				feedText = "Everything becomes a battle with siblings.",
			},
			{
				text = "Become partners in crime",
				effects = { Happiness = 6 },
				setFlags = { sibling_bond = true },
				feedText = "You and your sibling are an unstoppable team!",
			},
		},
	},
	
	-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
	-- EARLY CHILDHOOD EVENTS (Ages 5-8) - School and identity
	-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
	{
		id = "child_playground_adventure",
		title = "ğŸ¢ Playground Champion",
		emoji = "ğŸ¢",
		text = "The playground is calling! What will you conquer today?",
		minAge = 5, maxAge = 8,
		cooldown = 3,
		category = "childhood",
		tags = { "play", "physical", "social" },
		choices = {
			{
				text = "Master the monkey bars",
				effects = { Health = 4, Happiness = 4 },
				setFlags = { athletic_kid = true },
				feedText = "You swung across the monkey bars like a pro!",
			},
			{
				text = "Become king/queen of the swings",
				effects = { Happiness = 5 },
				feedText = "You swung so high you could see the whole world!",
			},
			{
				text = "Build the best sandcastle",
				effects = { Smarts = 3, Happiness = 3 },
				setFlags = { creative_builder = true },
				feedText = "Your sandcastle was the envy of the playground!",
			},
			{
				text = "Lead a game with other kids",
				effects = { Happiness = 5 },
				setFlags = { natural_leader = true },
				feedText = "Everyone wanted to play YOUR game!",
			},
		},
	},
	{
		id = "child_show_and_tell",
		title = "ğŸ’ Show and Tell",
		emoji = "ğŸ¤",
		text = "It's show and tell day at school! What do you bring?",
		minAge = 5, maxAge = 8,
		oneTime = true,
		category = "childhood",
		tags = { "school", "presentation", "social" },
		choices = {
			{
				text = "Your favorite toy",
				effects = { Happiness = 5 },
				feedText = "Everyone loved hearing about your best friend (the toy)!",
			},
			{
				text = "A bug you caught",
				effects = { Smarts = 3 },
				setFlags = { science_curious = true },
				feedText = "Some kids screamed, but you were proud of your find!",
			},
			{
				text = "Family photos",
				effects = { Happiness = 4 },
				setFlags = { family_oriented = true },
				feedText = "You shared stories about your family. So sweet!",
			},
			{
				text = "Something you made yourself",
				effects = { Smarts = 2, Looks = 2 },
				setFlags = { crafty = true },
				feedText = "Your handmade creation impressed everyone!",
			},
		},
	},
	{
		id = "child_reading_discovery",
		title = "ğŸ“– Reading Breakthrough",
		emoji = "ğŸ“š",
		text = "You're starting to read on your own!",
		minAge = 5, maxAge = 7,
		oneTime = true,
		isMilestone = true,
		category = "childhood",
		tags = { "school", "reading", "milestone" },
		choices = {
			{
				text = "Devour books hungrily",
				effects = { Smarts = 6 },
				setFlags = { bookworm = true },
				feedText = "You can't stop reading! A whole world opened up.",
			},
			{
				text = "Prefer picture books",
				effects = { Smarts = 3, Happiness = 3 },
				setFlags = { visual_learner = true },
				feedText = "Pictures tell the best stories!",
			},
			{
				text = "Read comic books",
				effects = { Smarts = 4, Happiness = 4 },
				setFlags = { comic_fan = true },
				feedText = "Superheroes and adventures! Comics are the best!",
			},
			{
				text = "Reading is boring",
				effects = { Happiness = 2 },
				setFlags = { non_reader = true },
				feedText = "Books? Meh. You'd rather be doing other things.",
			},
		},
	},
	{
		id = "child_first_crush",
		title = "ğŸ’• Butterflies",
		emoji = "ğŸ’•",
		text = "You notice someone at school makes you feel... weird. In a good way?",
		minAge = 7, maxAge = 10,
		oneTime = true,
		category = "childhood",
		tags = { "social", "crush", "emotions" },
		choices = {
			{
				text = "Become too shy to talk to them",
				effects = { Happiness = 2 },
				setFlags = { shy_around_crushes = true },
				feedText = "You turned bright red whenever they looked at you.",
			},
			{
				text = "Pull their hair/tease them",
				effects = { Happiness = 2 },
				setFlags = { awkward_flirter = true },
				feedText = "Classic kid move. They didn't get it.",
			},
			{
				text = "Try to impress them",
				effects = { Happiness = 3 },
				feedText = "You showed off your best skills!",
			},
			{
				text = "Ew, cooties!",
				effects = { Happiness = 3 },
				feedText = "Crushes? No thank you! You've got better things to do.",
			},
		},
	},
	{
		id = "child_sports_tryout",
		title = "âš½ Sports Team Tryouts",
		emoji = "ğŸ†",
		text = "There's a kids' sports league in town. Want to try out?",
		minAge = 6, maxAge = 10,
		cooldown = 4,
		category = "childhood",
		tags = { "sports", "activities", "social" },
		choices = {
			{
				text = "Try out for soccer",
				effects = {},
				feedText = "Soccer tryouts here we come!",
				onResolve = function(state)
					local health = state.Stats and state.Stats.Health or 50
					local roll = math.random(1, 100) + (health / 5)
					if roll > 55 then
						state:ModifyStat("Health", 5)
						state:ModifyStat("Happiness", 5)
						state.Flags = state.Flags or {}
						state.Flags.plays_soccer = true
						state.Flags.team_player = true
						state:AddFeed("âš½ You made the team! Go team!")
					else
						state:ModifyStat("Happiness", -3)
						state:AddFeed("âš½ Didn't make it this time. Maybe next year.")
					end
				end,
			},
			{
				text = "Try out for basketball",
				effects = {},
				feedText = "Time to shoot some hoops!",
				onResolve = function(state)
					local health = state.Stats and state.Stats.Health or 50
					local roll = math.random(1, 100) + (health / 5)
					if roll > 55 then
						state:ModifyStat("Health", 5)
						state:ModifyStat("Happiness", 5)
						state.Flags = state.Flags or {}
						state.Flags.plays_basketball = true
						state.Flags.team_player = true
						state:AddFeed("ğŸ€ You made the basketball team!")
					else
						state:ModifyStat("Happiness", -3)
						state:AddFeed("ğŸ€ Didn't make the cut. Keep practicing!")
					end
				end,
			},
			{
				text = "Try swimming instead",
				effects = { Health = 4, Happiness = 3 },
				setFlags = { swimmer = true },
				feedText = "You joined the swim team! Water baby!",
			},
			{
				text = "Sports aren't for me",
				effects = { Happiness = 2 },
				feedText = "You'd rather spend time on other interests.",
			},
		},
	},
	{
		id = "child_music_lesson",
		title = "ğŸµ Music Discovery",
		emoji = "ğŸ¹",
		text = "Your parents want you to try music lessons.",
		minAge = 5, maxAge = 10,
		oneTime = true,
		category = "childhood",
		tags = { "music", "activities", "skills" },
		choices = {
			{
				text = "Learn piano",
				effects = { Smarts = 3, Happiness = 2 },
				setFlags = { plays_piano = true, musical = true },
				feedText = "Tickling the ivories! You're learning piano.",
			},
			{
				text = "Learn guitar",
				effects = { Happiness = 4, Looks = 2 },
				setFlags = { plays_guitar = true, musical = true },
				feedText = "Rock star in training! You're learning guitar.",
			},
			{
				text = "Learn drums",
				effects = { Happiness = 5, Health = 2 },
				setFlags = { plays_drums = true, musical = true },
				feedText = "Bang bang! Your neighbors probably hate you now.",
			},
			{
				text = "Music isn't my thing",
				effects = { Happiness = 1 },
				feedText = "You'd rather spend time on other activities.",
			},
		},
	},
	
	-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
	-- LATE CHILDHOOD EVENTS (Ages 9-12) - Growing up
	-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
	{
		id = "child_video_games_discovery",
		title = "ğŸ® Gaming World",
		emoji = "ğŸ®",
		text = "You've discovered video games!",
		minAge = 8, maxAge = 12,
		oneTime = true,
		category = "childhood",
		tags = { "games", "technology", "hobby" },
		choices = {
			{
				text = "Become a dedicated gamer",
				effects = { Happiness = 5 },
				setFlags = { gamer = true, tech_savvy = true },
				feedText = "Games are LIFE. You play every chance you get.",
			},
			{
				text = "Play casually with friends",
				effects = { Happiness = 4 },
				setFlags = { casual_gamer = true },
				feedText = "Gaming is more fun with friends!",
			},
			{
				text = "Prefer outdoor activities",
				effects = { Health = 3, Happiness = 3 },
				setFlags = { outdoor_kid = true },
				feedText = "Games are okay, but you'd rather be outside.",
			},
			{
				text = "Get interested in how games are made",
				effects = { Smarts = 4 },
				setFlags = { future_developer = true, coder = true },
				feedText = "Wait... you can MAKE games? Tell me more!",
			},
		},
	},
	-- REMOVED: child_puberty_begins - Roblox TOS compliance
	{
		id = "child_summer_camp",
		title = "ğŸ•ï¸ Summer Camp",
		emoji = "ğŸ•ï¸",
		text = "Your parents are sending you to summer camp!",
		minAge = 8, maxAge = 12,
		cooldown = 4,
		category = "childhood",
		tags = { "summer", "camp", "adventure" },
		choices = {
			{
				text = "Arts & crafts camp",
				effects = { Smarts = 2, Happiness = 4, Looks = 2 },
				setFlags = { camp_artist = true },
				feedText = "You made friendship bracelets and tie-dye shirts!",
			},
			{
				text = "Sports camp",
				effects = { Health = 5, Happiness = 3 },
				setFlags = { camp_athlete = true },
				feedText = "You trained hard and made the team better!",
			},
			{
				text = "Science/tech camp",
				effects = { Smarts = 5, Happiness = 3 },
				setFlags = { camp_scientist = true, tech_savvy = true },
				feedText = "You built robots and coded games!",
			},
			{
				text = "Wilderness survival camp",
				effects = { Health = 4, Smarts = 3, Happiness = 4 },
				setFlags = { camp_survivor = true, outdoor_skills = true },
				feedText = "You learned to start fires and navigate the woods!",
			},
		},
	},
	{
		id = "child_allowance_lesson",
		title = "ğŸ’° First Money Lesson",
		emoji = "ğŸ’°",
		text = "You've started getting an allowance! What do you do with it?",
		minAge = 8, maxAge = 12,
		oneTime = true,
		category = "childhood",
		tags = { "money", "lessons", "responsibility" },
		choices = {
			{
				text = "Save everything",
				effects = { Smarts = 3, Money = 50 },
				setFlags = { saver = true },
				feedText = "Your piggy bank is getting heavy! Smart saving.",
			},
			{
				text = "Spend it immediately",
				effects = { Happiness = 4 },
				setFlags = { spender = true },
				feedText = "Candy and toys! Who needs savings?",
			},
			{
				text = "Start a little business",
				effects = { Smarts = 5, Money = 30 },
				setFlags = { young_entrepreneur = true },
				feedText = "Lemonade stand! You're making bank!",
			},
			{
				text = "Give to charity",
				effects = { Happiness = 5 },
				setFlags = { charitable_kid = true },
				feedText = "You donated some to help others. What a kind heart!",
			},
		},
	},
	
	-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
	-- TEEN EVENTS (Ages 13-18) - Identity and decisions
	-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
	{
		id = "teen_social_media_debut",
		title = "ğŸ“± Social Media Debut",
		emoji = "ğŸ“±",
		text = "You finally got permission to have social media accounts!",
		minAge = 13, maxAge = 15,
		oneTime = true,
		category = "teen",
		tags = { "social_media", "online", "milestone" },
		choices = {
			{
				text = "Post everything",
				effects = { Happiness = 4 },
				setFlags = { social_media_active = true, oversharer = true },
				feedText = "Your life is now documented for everyone to see!",
			},
			{
				text = "Lurk mostly",
				effects = { Smarts = 2, Happiness = 2 },
				setFlags = { social_media_lurker = true },
				feedText = "You prefer watching others than posting yourself.",
			},
			{
				text = "Focus on making content",
				effects = { Smarts = 3, Looks = 2 },
				setFlags = { content_creator = true, social_media_active = true },
				feedText = "You're building a following with your creative posts!",
			},
			{
				text = "Meh, not interested",
				effects = { Happiness = 2 },
				setFlags = { social_media_free = true },
				feedText = "You'll pass on the digital drama.",
			},
		},
	},
	{
		id = "teen_study_habits",
		title = "ğŸ“š Study Strategies",
		emoji = "ğŸ“š",
		text = "High school is getting harder. How do you approach studying?",
		minAge = 13, maxAge = 16,
		cooldown = 4,
		category = "teen",
		tags = { "school", "study", "academics" },
		choices = {
			{
				text = "Organize and plan meticulously",
				effects = { Smarts = 5 },
				setFlags = { organized_student = true },
				feedText = "Color-coded notes and study schedules. You've got this!",
			},
			{
				text = "Cram the night before",
				effects = { Smarts = 2, Health = -2 },
				setFlags = { procrastinator = true },
				feedText = "Last-minute panic studying. A classic strategy.",
			},
			{
				text = "Form study groups",
				effects = { Smarts = 4, Happiness = 3 },
				setFlags = { study_group_member = true },
				feedText = "Learning together is more fun and effective!",
			},
			{
				text = "Just wing it",
				effects = { Happiness = 3 },
				setFlags = { wings_it = true },
				feedText = "How hard can it be? You'll figure it out.",
			},
		},
	},
	{
		id = "teen_part_time_job_decision",
		title = "ğŸ’¼ Part-Time Job?",
		emoji = "ğŸ’¼",
		text = "You're old enough to get a part-time job now. Interested?",
		minAge = 15, maxAge = 17,
		cooldown = 4,
		category = "teen",
		tags = { "work", "money", "responsibility" },
		-- Only show if player doesn't already have a job
		eligibility = function(state)
			return not state.CurrentJob
		end,
		choices = {
			{
				text = "Get a job at a fast food place",
				effects = { Money = 200, Smarts = 2 },
				setFlags = { has_teen_job = true, work_experience = true },
				feedText = "Would you like fries with that? You're employed!",
			},
			{
				text = "Work at a retail store",
				effects = { Money = 180, Happiness = 2 },
				setFlags = { has_teen_job = true, retail_experience = true },
				feedText = "Welcome to the world of customer service!",
			},
			{
				text = "Tutor younger kids",
				effects = { Money = 150, Smarts = 4 },
				setFlags = { has_teen_job = true, teaching_experience = true },
				feedText = "You're helping others learn while making money!",
			},
			{
				text = "Focus on school instead",
				effects = { Smarts = 3 },
				feedText = "Money can wait. Academics come first.",
			},
		},
	},
	{
		id = "teen_friend_drama",
		title = "ğŸ˜¤ Friend Group Drama",
		emoji = "ğŸ˜¤",
		text = "There's drama brewing in your friend group. What do you do?",
		minAge = 13, maxAge = 17,
		cooldown = 3,
		category = "teen",
		tags = { "friends", "drama", "social" },
		choices = {
			{
				text = "Try to mediate",
				effects = { Smarts = 3, Happiness = 2 },
				setFlags = { peacemaker = true },
				feedText = "You helped everyone work through it. Diplomacy!",
			},
			{
				text = "Pick a side",
				effects = { Happiness = -2 },
				feedText = "You chose sides. Not everyone is happy with you.",
			},
			{
				text = "Stay out of it",
				effects = { Happiness = 3 },
				setFlags = { avoids_drama = true },
				feedText = "Not your circus, not your monkeys.",
			},
			{
				text = "Make it worse accidentally",
				effects = { Happiness = -5 },
				setFlags = { drama_magnet = true },
				feedText = "Somehow you made everything worse. Oops.",
			},
		},
	},
	{
		id = "teen_future_planning",
		title = "ğŸ“ Planning Your Future",
		emoji = "ğŸ“",
		text = "Adults keep asking what you want to do after high school. Any ideas?",
		minAge = 15, maxAge = 17,
		cooldown = 4,
		category = "teen",
		tags = { "future", "career", "planning" },
		choices = {
			{
				text = "College/university",
				effects = { Smarts = 3 },
				setFlags = { college_bound = true, has_plan = true },
				feedText = "Higher education is the plan. Time to study!",
			},
			{
				text = "Trade school",
				effects = { Smarts = 2, Health = 2 },
				setFlags = { trade_school_bound = true, has_plan = true },
				feedText = "Learn a practical skill and get to work!",
			},
			{
				text = "Start working right away",
				effects = { Money = 50 },
				setFlags = { workforce_bound = true, has_plan = true },
				feedText = "Why wait? The job market awaits!",
			},
			{
				text = "I'll figure it out later",
				effects = { Happiness = 2 },
				setFlags = { no_plan_yet = true },
				feedText = "There's time! You'll figure it out eventually.",
			},
		},
	},
	{
		id = "teen_first_heartbreak",
		title = "ğŸ’” First Heartbreak",
		emoji = "ğŸ’”",
		text = "Someone you liked doesn't feel the same way. It hurts.",
		minAge = 14, maxAge = 18,
		oneTime = true,
		category = "teen",
		tags = { "relationships", "emotions", "growth" },
		choices = {
			{
				text = "Cry it out",
				effects = { Happiness = -5, Smarts = 2 },
				setFlags = { heartbroken = true, emotional_processor = true },
				feedText = "You let yourself feel sad. It's part of healing.",
			},
			{
				text = "Throw yourself into hobbies",
				effects = { Happiness = 2, Smarts = 3 },
				setFlags = { heartbroken = true, copes_with_activities = true },
				feedText = "You distracted yourself by being productive.",
			},
			{
				text = "Talk to friends about it",
				effects = { Happiness = 3 },
				setFlags = { heartbroken = true, talks_about_feelings = true },
				feedText = "Friends helped you feel better. That's what they're for!",
			},
			{
				text = "Pretend you don't care",
				effects = { Happiness = -2 },
				setFlags = { heartbroken = true, bottles_emotions = true },
				feedText = "Whatever. It's fine. You're fine. (You're not fine.)",
			},
		},
	},
	
	-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
	-- YOUNG ADULT EVENTS (Ages 18-25) - Independence and identity
	-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
	{
		id = "young_adult_adulting_struggle",
		title = "ğŸ“‹ Adulting is Hard",
		emoji = "ğŸ“‹",
		text = "You're legally an adult now. Time to figure out... everything.",
		minAge = 18, maxAge = 22,
		oneTime = true,
		category = "adult",
		tags = { "adulting", "independence", "learning" },
		choices = {
			{
				text = "Tackle it head-on",
				effects = { Smarts = 4, Happiness = 3 },
				setFlags = { responsible_adult = true },
				feedText = "Taxes, bills, appointments... you've got this!",
			},
			{
				text = "Ask parents for help",
				effects = { Smarts = 2, Happiness = 2 },
				setFlags = { asks_for_guidance = true },
				feedText = "Your parents helped you learn the ropes.",
			},
			{
				text = "Wing it and learn from mistakes",
				effects = { Smarts = 3 },
				setFlags = { learns_hard_way = true },
				feedText = "Trial and error! Mostly error at first, but you're learning.",
			},
			{
				text = "Procrastinate and panic",
				effects = { Happiness = -3 },
				setFlags = { overwhelmed_adult = true },
				feedText = "This is too much. Maybe tomorrow?",
			},
		},
	},
	{
		id = "young_adult_first_apartment",
		title = "ğŸ  First Apartment",
		emoji = "ğŸ ",
		text = "You're signing your first lease! Your own place at last!",
		minAge = 18, maxAge = 25,
		oneTime = true,
		-- Only show if already moved out
		requiresFlags = { lives_alone = true },
		category = "adult",
		tags = { "housing", "independence", "milestone" },
		choices = {
			{
				text = "Decorate it perfectly",
				effects = { Happiness = 6, Money = -200 },
				setFlags = { interior_designer = true },
				feedText = "Your place looks AMAZING. Pinterest-worthy!",
			},
			{
				text = "Keep it minimal",
				effects = { Happiness = 3, Money = 50 },
				setFlags = { minimalist = true },
				feedText = "Less stuff = less problems. Clean and simple.",
			},
			{
				text = "Make it cozy",
				effects = { Happiness = 5 },
				setFlags = { homebody = true },
				feedText = "Blankets, plants, and comfort. Your happy place!",
			},
			{
				text = "It's basically just for sleeping",
				effects = { Happiness = 2 },
				feedText = "Who cares about decor? You're never home anyway.",
			},
		},
	},
	{
		id = "young_adult_career_crossroads",
		title = "ğŸ›¤ï¸ Career Crossroads",
		emoji = "ğŸ›¤ï¸",
		text = "You're at a crossroads in your career. Time to decide.",
		minAge = 22, maxAge = 28,
		cooldown = 4,
		category = "adult",
		tags = { "career", "decisions", "future" },
		choices = {
			{
				text = "Double down on current path",
				effects = { Smarts = 3 },
				setFlags = { career_focused = true },
				feedText = "You're committed to your current career. Onward!",
			},
			{
				text = "Explore new opportunities",
				effects = { Happiness = 4, Smarts = 2 },
				setFlags = { career_explorer = true },
				feedText = "Maybe there's something better out there!",
			},
			{
				-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
				-- CRITICAL FIX #AAA-4: Going back to school now ACTUALLY quits job and enrolls!
				-- This was just setting a useless flag before - now it has real consequences
				-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
				text = "Quit job & go back to school",
				effects = { Smarts = 5, Happiness = 3 },
				setFlags = { returning_student = true, career_change_via_education = true },
				feedText = "You quit your job to pursue more education. A bold move!",
				triggerFollowUp = "school_enrollment_choice",
				onResolve = function(state)
					-- Actually quit the job!
					if state.CurrentJob then
						state.CareerInfo = state.CareerInfo or {}
						state.CareerInfo.careerHistory = state.CareerInfo.careerHistory or {}
						table.insert(state.CareerInfo.careerHistory, {
							job = state.CurrentJob.name,
							company = state.CurrentJob.company,
							salary = state.CurrentJob.salary,
							endReason = "quit_for_school",
							endAge = state.Age,
						})
						state.CurrentJob = nil
						state.Flags = state.Flags or {}
						state.Flags.employed = nil
						state.Flags.has_job = nil
						state.Flags.just_quit_for_school = true
					end
					if state.AddFeed then
						state:AddFeed("ğŸ“š You handed in your resignation. Time to hit the books again!")
					end
				end,
			},
			{
				text = "Focus on work-life balance",
				effects = { Happiness = 5, Health = 2 },
				setFlags = { work_life_balance = true },
				feedText = "Career isn't everything. Life matters too.",
			},
		},
	},
	-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
	-- CRITICAL FIX #AAA-5: Follow-up event for school enrollment after quitting
	-- This gives players actual school options after choosing to go back to school
	-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
	{
		id = "school_enrollment_choice",
		title = "ğŸ“ Choose Your Path",
		emoji = "ğŸ“",
		text = "Now that you've quit your job, what kind of education will you pursue?",
		minAge = 18, maxAge = 60,
		isFollowUp = true, -- Only triggered as a follow-up, not randomly
		oneTime = true,
		requiresFlags = { just_quit_for_school = true },
		category = "education",
		tags = { "school", "education", "career_change" },
		choices = {
			{
				text = "ğŸ“ Get a Bachelor's Degree (4 years, $80,000)",
				effects = { Smarts = 5 },
				feedText = "You enrolled in a 4-year university program!",
				eligibility = function(state)
					if state.Education and (state.Education == "bachelor" or state.Education == "master" or state.Education == "phd") then
						return false, "You already have a bachelor's degree or higher"
					end
					if (state.Money or 0) < 5000 then
						return false, "You need at least $5,000 to start (loans will cover the rest)"
					end
					return true
				end,
				onResolve = function(state)
					state.EducationData = state.EducationData or {}
					state.EducationData.Status = "enrolled"
					state.EducationData.Level = "bachelor"
					state.EducationData.Institution = "State University"
					state.EducationData.Progress = 0
					state.EducationData.Duration = 4
					state.EducationData.Year = 1
					state.EducationData.TotalYears = 4
					state.EducationData.Debt = (state.EducationData.Debt or 0) + 80000
					state.Flags = state.Flags or {}
					state.Flags.college_student = true
					state.Flags.just_quit_for_school = nil
					if state.AddFeed then
						state:AddFeed("ğŸ“ You enrolled at State University! Time to get that Bachelor's degree.")
					end
				end,
			},
			{
				text = "ğŸ« Community College (2 years, $15,000)",
				effects = { Smarts = 3 },
				feedText = "You enrolled in community college!",
				eligibility = function(state)
					if (state.Money or 0) < 2000 then
						return false, "You need at least $2,000 to start"
					end
					return true
				end,
				onResolve = function(state)
					state.EducationData = state.EducationData or {}
					state.EducationData.Status = "enrolled"
					state.EducationData.Level = "community"
					state.EducationData.Institution = "Community College"
					state.EducationData.Progress = 0
					state.EducationData.Duration = 2
					state.EducationData.Year = 1
					state.EducationData.TotalYears = 2
					state.EducationData.Debt = (state.EducationData.Debt or 0) + 15000
					state.Flags = state.Flags or {}
					state.Flags.community_college_student = true
					state.Flags.just_quit_for_school = nil
					if state.AddFeed then
						state:AddFeed("ğŸ« You enrolled at Community College! Affordable education FTW.")
					end
				end,
			},
			{
				text = "ğŸ“š Master's Degree (2 years, $60,000)",
				effects = { Smarts = 8 },
				feedText = "Time to get that Master's!",
				eligibility = function(state)
					if not state.Education or (state.Education ~= "bachelor" and state.Education ~= "community") then
						return false, "You need a Bachelor's degree first"
					end
					if (state.Money or 0) < 5000 then
						return false, "You need at least $5,000 to start"
					end
					return true
				end,
				onResolve = function(state)
					state.EducationData = state.EducationData or {}
					state.EducationData.Status = "enrolled"
					state.EducationData.Level = "master"
					state.EducationData.Institution = "Graduate School"
					state.EducationData.Progress = 0
					state.EducationData.Duration = 2
					state.EducationData.Year = 1
					state.EducationData.TotalYears = 2
					state.EducationData.Debt = (state.EducationData.Debt or 0) + 60000
					state.Flags = state.Flags or {}
					state.Flags.grad_student = true
					state.Flags.just_quit_for_school = nil
					if state.AddFeed then
						state:AddFeed("ğŸ“š You enrolled in a Master's program! Time for advanced studies.")
					end
				end,
			},
			{
				text = "ğŸ’¼ Trade School / Certification (1 year, $10,000)",
				effects = { Smarts = 4 },
				feedText = "You enrolled in a vocational program!",
				eligibility = function(state)
					if (state.Money or 0) < 2000 then
						return false, "You need at least $2,000 to start"
					end
					return true
				end,
				onResolve = function(state)
					state.EducationData = state.EducationData or {}
					state.EducationData.Status = "enrolled"
					state.EducationData.Level = "trade"
					state.EducationData.Institution = "Vocational School"
					state.EducationData.Progress = 0
					state.EducationData.Duration = 1
					state.EducationData.Year = 1
					state.EducationData.TotalYears = 1
					state.EducationData.Debt = (state.EducationData.Debt or 0) + 10000
					state.Flags = state.Flags or {}
					state.Flags.trade_school_student = true
					state.Flags.just_quit_for_school = nil
					if state.AddFeed then
						state:AddFeed("ğŸ’¼ You enrolled in trade school! Practical skills for the real world.")
					end
				end,
			},
		},
	},
	{
		id = "young_adult_fitness_resolution",
		title = "ğŸ’ª Fitness Journey",
		emoji = "ğŸ’ª",
		text = "You've decided to take fitness seriously. What's your approach?",
		minAge = 18, maxAge = 30,
		cooldown = 4,
		category = "adult",
		tags = { "fitness", "health", "lifestyle" },
		choices = {
			{
				text = "Join a gym",
				effects = { Health = 5, Money = -50 },
				setFlags = { gym_member = true },
				feedText = "Time to pump some iron! You joined a gym.",
			},
			{
				text = "Take up running",
				effects = { Health = 5, Happiness = 2 },
				setFlags = { runner = true },
				feedText = "You started running! It's free and effective.",
			},
			{
				text = "Try yoga/pilates",
				effects = { Health = 4, Happiness = 3 },
				setFlags = { yoga_practitioner = true },
				feedText = "Flexibility and mindfulness combined. Namaste!",
			},
			{
				text = "Workout at home",
				effects = { Health = 4 },
				setFlags = { home_workout = true },
				feedText = "YouTube workouts and pushups. No excuses!",
			},
		},
	},
	{
		id = "young_adult_financial_habits",
		title = "ğŸ’¸ Financial Habits",
		emoji = "ğŸ’¸",
		text = "You're starting to think more seriously about money management.",
		minAge = 20, maxAge = 28,
		oneTime = true,
		category = "adult",
		tags = { "money", "finance", "habits" },
		choices = {
			{
				text = "Start budgeting strictly",
				effects = { Smarts = 4, Money = 100 },
				setFlags = { budgeter = true },
				feedText = "Every dollar has a purpose. You're tracking it all!",
			},
			{
				text = "Open investment accounts",
				effects = { Smarts = 4, Money = 50 },
				setFlags = { investor = true },
				feedText = "Your money is working for you now!",
			},
			{
				text = "Focus on paying off debt",
				effects = { Smarts = 2, Money = 30 },
				setFlags = { debt_focused = true },
				feedText = "Getting out of debt is your priority.",
			},
			{
				text = "YOLO - enjoy your money",
				effects = { Happiness = 4 },
				setFlags = { spender_lifestyle = true },
				feedText = "Life is short! Spend now, worry later.",
			},
		},
	},
	{
		id = "young_adult_relationship_milestone",
		title = "ğŸ’• Relationship Milestone",
		emoji = "ğŸ’•",
		text = "Your relationship is getting more serious. Big decisions ahead.",
		minAge = 20, maxAge = 30,
		cooldown = 4,
		category = "adult",
		tags = { "relationships", "love", "decisions" },
		requiresPartner = true,
		choices = {
			{
				text = "Move in together",
				effects = { Happiness = 6, Money = 100 },
				setFlags = { cohabiting = true },
				feedText = "You're living together! A big step!",
			},
			{
				text = "Take things slow",
				effects = { Happiness = 3, Smarts = 2 },
				setFlags = { takes_it_slow = true },
				feedText = "No rush. Good things take time.",
			},
			{
				text = "Start talking about the future",
				effects = { Happiness = 4 },
				setFlags = { future_planning_partner = true },
				feedText = "Where is this relationship going? Time to discuss.",
			},
			{
				text = "Question if they're the one",
				effects = { Happiness = -2, Smarts = 2 },
				setFlags = { relationship_doubts = true },
				feedText = "You're having some doubts... normal or a sign?",
			},
		},
	},
	
	-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
	-- LATE 20s EVENTS (Ages 25-30) - Settling into adulthood
	-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
	{
		id = "late_20s_life_assessment",
		title = "ğŸ¤” Life Assessment",
		emoji = "ğŸ¤”",
		-- CRITICAL FIX #802: Dynamic text based on actual player state!
		-- User complaint: "Life Assessment doesn't check if I'm famous"
		text = "You're approaching 30. Time to assess where you are in life.",
		minAge = 27, maxAge = 30,
		oneTime = true,
		isMilestone = true,
		category = "adult",
		tags = { "life", "reflection", "milestone" },
		-- CRITICAL FIX: Generate dynamic text based on player's actual life
		getDynamicText = function(state)
			local money = state.Money or 0
			local fame = state.Fame or 0
			local happiness = (state.Stats and state.Stats.Happiness) or state.Happiness or 50
			local hasJob = state.CurrentJob ~= nil
			local jobName = hasJob and state.CurrentJob.name or nil
			local isRich = money >= 100000
			local isPoor = money < 5000
			local isFamous = fame >= 30
			local isHappy = happiness >= 70
			local isSad = happiness < 40
			
			local text = "You're approaching 30. "
			
			-- Fame-based intro
			if isFamous and fame >= 70 then
				text = "As a famous figure approaching 30, you reflect on your incredible journey. "
			elseif isFamous then
				text = "With your growing fame, approaching 30 feels different. People know your name. "
			end
			
			-- Money-based addition
			if isRich and money >= 1000000 then
				text = text .. string.format("With $%s in the bank, you've achieved financial success beyond your dreams. ", 
					money >= 1000000 and string.format("%.1fM", money/1000000) or string.format("%.0fK", money/1000))
			elseif isRich then
				text = text .. "You've built a solid financial foundation. "
			elseif isPoor then
				text = text .. "Money is tight, and you're still figuring out financial stability. "
			end
			
			-- Career-based addition
			if hasJob then
				text = text .. string.format("Your career as a %s defines much of your identity. ", jobName)
			else
				text = text .. "You're still searching for your career path. "
			end
			
			-- Happiness-based addition
			if isHappy then
				text = text .. "Overall, life feels pretty good."
			elseif isSad then
				text = text .. "Something feels missing though."
			else
				text = text .. "Time to assess where you really are."
			end
			
			return { text = text, money = money, fame = fame, happiness = happiness }
		end,
		choices = {
			{
				text = "I'm exactly where I want to be",
				effects = { Happiness = 8 },
				setFlags = { life_on_track = true },
				feedText = "Things are going great! You're proud of your progress.",
				-- CRITICAL FIX: Dynamic feedback based on actual status
				onResolve = function(state)
					local money = state.Money or 0
					local fame = state.Fame or 0
					if fame >= 50 then
						state:ModifyStat("Happiness", 5)
						state:AddFeed("â­ You're famous AND happy with life! Living the dream!")
					elseif money >= 500000 then
						state:ModifyStat("Happiness", 5)
						state:AddFeed("ğŸ’° Rich and content! You've made it!")
					else
						state:AddFeed("ğŸ¤” You're satisfied with your life at nearly 30.")
					end
				end,
			},
			{
				text = "I need to make some changes",
				effects = { Smarts = 3, Happiness = 2 },
				setFlags = { ready_for_change = true },
				feedText = "Time to shake things up and pursue what really matters.",
			},
			{
				text = "I'm not sure anymore",
				effects = { Happiness = -2, Smarts = 2 },
				setFlags = { quarter_life_crisis = true },
				feedText = "Everything felt clearer when you were younger...",
				onResolve = function(state)
					local money = state.Money or 0
					if money < 10000 then
						state:ModifyStat("Happiness", -5)
						state:AddFeed("ğŸ˜° Broke and approaching 30... the panic is real.")
					end
				end,
			},
			{
				text = "I'm just going with the flow",
				effects = { Happiness = 3 },
				setFlags = { go_with_flow = true },
				feedText = "Life happens. You're along for the ride!",
			},
		},
	},
	{
		id = "late_20s_hobby_serious",
		title = "ğŸ¯ Serious About Hobbies",
		emoji = "ğŸ¯",
		text = "A hobby has become more than just a pastime. Time to commit?",
		minAge = 25, maxAge = 30,
		cooldown = 4,
		category = "adult",
		tags = { "hobbies", "passion", "lifestyle" },
		choices = {
			{
				text = "Turn it into a side hustle",
				effects = { Smarts = 3, Money = 100 },
				setFlags = { side_hustle = true },
				feedText = "Your hobby is now making you money!",
			},
			{
				text = "Invest in better equipment",
				effects = { Happiness = 4, Money = -200 },
				setFlags = { hobby_investor = true },
				feedText = "Quality gear makes all the difference!",
			},
			{
				text = "Join a community",
				effects = { Happiness = 5 },
				setFlags = { hobby_community = true },
				feedText = "You found your people! Shared passions unite.",
			},
			{
				text = "Keep it casual",
				effects = { Happiness = 3 },
				feedText = "It's nice as a hobby. No need to overcommit.",
			},
		},
	},
	{
		id = "late_20s_social_circle_shift",
		title = "ğŸ‘¥ Friendships Evolving",
		emoji = "ğŸ‘¥",
		text = "Your social circle is changing as everyone's lives evolve.",
		minAge = 26, maxAge = 30,
		oneTime = true,
		category = "adult",
		tags = { "friends", "social", "change" },
		choices = {
			{
				text = "Make effort to maintain friendships",
				effects = { Happiness = 5 },
				setFlags = { friendship_maintainer = true },
				feedText = "You schedule regular catch-ups. Friendships matter!",
			},
			{
				text = "Let some friendships fade naturally",
				effects = { Happiness = 2 },
				setFlags = { selective_friends = true },
				feedText = "Quality over quantity. You focus on close friends.",
			},
			{
				text = "Seek out new connections",
				effects = { Happiness = 4, Smarts = 2 },
				setFlags = { making_new_friends = true },
				feedText = "New friends bring new perspectives!",
			},
			{
				text = "Content with partner/family",
				effects = { Happiness = 3 },
				setFlags = { family_focused = true },
				feedText = "Your inner circle is small but meaningful.",
			},
		},
	},
	{
		id = "late_20s_health_wake_up",
		title = "âš•ï¸ Health Wake-Up Call",
		emoji = "âš•ï¸",
		-- CRITICAL FIX #803: Only show if health is actually low!
		-- User complaint: "Health wake-up call keeps showing but I'm pretty healthy"
		text = "Your body is reminding you that you're not a teenager anymore.",
		minAge = 25, maxAge = 30,
		cooldown = 6, -- Increased cooldown
		oneTime = true, -- Only once per life
		category = "adult",
		tags = { "health", "lifestyle", "awareness" },
		-- CRITICAL FIX: Only trigger if health is actually concerning!
		eligibility = function(state)
			local health = (state.Stats and state.Stats.Health) or state.Health or 50
			local looks = (state.Stats and state.Stats.Looks) or state.Looks or 50
			-- Only show if health is below 60 OR looks dropped significantly
			if health >= 70 and looks >= 60 then
				return false, "Player is already healthy - no wake-up call needed"
			end
			return true
		end,
		blockedByFlags = { health_wake_up_done = true },
		-- Dynamic text based on actual health
		getDynamicText = function(state)
			local health = (state.Stats and state.Stats.Health) or state.Health or 50
			local looks = (state.Stats and state.Stats.Looks) or state.Looks or 50
			
			local text
			if health < 40 then
				text = "You're feeling exhausted and run down. At only " .. math.floor(health) .. "% health, something has to change."
			elseif health < 60 then
				text = "You've been neglecting your body. With " .. math.floor(health) .. "% health, you're not at your best."
			elseif looks < 50 then
				text = "You don't recognize yourself in the mirror lately. Stress and bad habits are showing."
			else
				text = "Your body is starting to send you subtle signals. You're not as invincible as you thought."
			end
			
			return { text = text, currentHealth = health }
		end,
		choices = {
			{
				text = "Start taking health seriously",
				effects = { Health = 5, Smarts = 2 },
				setFlags = { health_conscious = true, health_wake_up_done = true },
				feedText = "Better eating, more sleep, regular checkups. You're on it!",
				onResolve = function(state)
					local health = (state.Stats and state.Stats.Health) or state.Health or 50
					if health < 40 then
						state:ModifyStat("Health", 10)
						state:AddFeed("âš•ï¸ Major lifestyle overhaul! You feel SO much better!")
					else
						state:AddFeed("âš•ï¸ Good habits established. Health improving!")
					end
				end,
			},
			{
				text = "Ignore it, you're still young",
				effects = { Happiness = 2, Health = -2 },
				setFlags = { ignores_health = true, health_wake_up_done = true },
				feedText = "You'll deal with it later... right?",
			},
			{
				text = "Make small sustainable changes",
				effects = { Health = 3, Happiness = 2 },
				setFlags = { gradual_health = true, health_wake_up_done = true },
				feedText = "Little improvements add up over time.",
			},
			{
				text = "Obsess over it",
				effects = { Health = 3, Happiness = -2 },
				setFlags = { health_obsessed = true, health_wake_up_done = true },
				feedText = "You track everything. Maybe too much?",
			},
		},
	},
}

return ProgressiveLifeEvents
